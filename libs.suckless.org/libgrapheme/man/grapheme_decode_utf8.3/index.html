<!doctype html>
<html>
<head>
	<meta charset="utf-8"/>
	<title>libraries | suckless.org software that sucks less</title>
	<link rel="stylesheet" type="text/css" href="http://suckless.org/pub/style.css"/>
</head>

<div id="header">
	<a href="http://suckless.org/"><img src="http://suckless.org/logo.svg" alt=""/></a>&nbsp;
	<a id="headerLink" href="http://suckless.org/">suckless.org</a>
	<span class="hidden"> - </span>
	<span id="headerSubtitle">libraries</span>
</div>
<hr class="hidden"/>
<div id="menu">
	<a href="http://suckless.org/">home</a>
	<a href="http://dwm.suckless.org/">dwm</a>
	<a href="http://st.suckless.org/">st</a>
	<a href="http://core.suckless.org/">core</a>
	<a href="http://surf.suckless.org/">surf</a>
	<a href="http://tools.suckless.org/">tools</a>
	<a href="../../../index.html"><b>libs</b></a>
	<a href="http://ev.suckless.org/">e.V.</a>
	<span class="right">
		<a href="http://dl.suckless.org/">download</a>
		<a href="http://git.suckless.org/">source</a>
	</span>
</div>
<hr class="hidden"/>
<div id="content">
<div id="nav">
	<ul>
	<li><a href="../../../index.html">about</a></li>
	<li><a href="../../../deprecated/index.html">deprecated/</a></li>
	<li><a href="../../index.html"><b>libgrapheme/</b></a>
		<ul>
		<li><a href="../index.html"><b>man/</b></a>
			<ul>
			<li><a href="index.html"><b>grapheme decode utf8.3/</b></a></li>
			<li><a href="../grapheme_encode_utf8.3/index.html">grapheme encode utf8.3/</a></li>
			<li><a href="../grapheme_is_character_break.3/index.html">grapheme is character break.3/</a></li>
			<li><a href="../grapheme_is_lowercase.3/index.html">grapheme is lowercase.3/</a></li>
			<li><a href="../grapheme_is_lowercase_utf8.3/index.html">grapheme is lowercase utf8.3/</a></li>
			<li><a href="../grapheme_is_titlecase.3/index.html">grapheme is titlecase.3/</a></li>
			<li><a href="../grapheme_is_titlecase_utf8.3/index.html">grapheme is titlecase utf8.3/</a></li>
			<li><a href="../grapheme_is_uppercase.3/index.html">grapheme is uppercase.3/</a></li>
			<li><a href="../grapheme_is_uppercase_utf8.3/index.html">grapheme is uppercase utf8.3/</a></li>
			<li><a href="../grapheme_next_character_break.3/index.html">grapheme next character break.3/</a></li>
			<li><a href="../grapheme_next_character_break_utf8.3/index.html">grapheme next character break utf8.3/</a></li>
			<li><a href="../grapheme_next_line_break.3/index.html">grapheme next line break.3/</a></li>
			<li><a href="../grapheme_next_line_break_utf8.3/index.html">grapheme next line break utf8.3/</a></li>
			<li><a href="../grapheme_next_sentence_break.3/index.html">grapheme next sentence break.3/</a></li>
			<li><a href="../grapheme_next_sentence_break_utf8.3/index.html">grapheme next sentence break utf8.3/</a></li>
			<li><a href="../grapheme_next_word_break.3/index.html">grapheme next word break.3/</a></li>
			<li><a href="../grapheme_next_word_break_utf8.3/index.html">grapheme next word break utf8.3/</a></li>
			<li><a href="../grapheme_to_lowercase.3/index.html">grapheme to lowercase.3/</a></li>
			<li><a href="../grapheme_to_lowercase_utf8.3/index.html">grapheme to lowercase utf8.3/</a></li>
			<li><a href="../grapheme_to_titlecase.3/index.html">grapheme to titlecase.3/</a></li>
			<li><a href="../grapheme_to_titlecase_utf8.3/index.html">grapheme to titlecase utf8.3/</a></li>
			<li><a href="../grapheme_to_uppercase.3/index.html">grapheme to uppercase.3/</a></li>
			<li><a href="../grapheme_to_uppercase_utf8.3/index.html">grapheme to uppercase utf8.3/</a></li>
			<li><a href="../libgrapheme.7/index.html">libgrapheme.7/</a></li>
			</ul>
		</li>
		</ul>
	</li>
	<li><a href="../../../libzahl/index.html">libzahl/</a></li>
	</ul>
</div>
<hr class="hidden"/>
<div id="main">

<p>GRAPHEME_DECODE_UTF8(3) - Library Functions Manual</p>
<h1>NAME</h1>
<p><strong>grapheme_decode_utf8</strong> - decode first codepoint in UTF-8-encoded string</p>
<h1>SYNOPSIS</h1>
<p><strong>#include &lt;grapheme.h&gt;</strong></p>
<p><em>size_t</em><br />  
<strong>grapheme_decode_utf8</strong>(<em>const char *str</em>, <em>size_t len</em>, <em>uint_least32_t *cp</em>);</p>
<h1>DESCRIPTION</h1>
<p>The
<strong>grapheme_decode_utf8</strong>()
function decodes the first codepoint in the UTF-8-encoded string
<em>str</em>
of length
<em>len</em>.
If the UTF-8-sequence is invalid (overlong encoding, unexpected byte,
string ends unexpectedly, empty string, etc.) the decoding is stopped
at the last processed byte and the decoded codepoint set to
<code>GRAPHEME_INVALID_CODEPOINT</code>.</p>
<p>If
<em>cp</em>
is not
<code>NULL</code>
the decoded codepoint is stored in the memory pointed to by
<em>cp</em>.</p>
<p>Given NUL has a unique 1 byte representation, it is safe to operate on
NUL-terminated strings by setting
<em>len</em>
to
<code>SIZE_MAX</code>
(stdint.h is already included by grapheme.h) and terminating when
<em>cp</em>
is 0 (see
<em>EXAMPLES</em>
for an example).</p>
<h1>RETURN VALUES</h1>
<p>The
<strong>grapheme_decode_utf8</strong>()
function returns the number of processed bytes and 0 if
<em>str</em>
is
<code>NULL</code>
or
<em>len</em>
is 0.
If the string ends unexpectedly in a multibyte sequence, the desired
length (that is larger than
<em>len</em>)
is returned.</p>
<h1>EXAMPLES</h1>
<pre><code>/* cc (-static) -o example example.c -lgrapheme */
#include &lt;grapheme.h&gt;
#include &lt;inttypes.h&gt;
#include &lt;stdio.h&gt;

void
print_cps(const char *str, size_t len)
{
	size_t ret, off;
	uint_least32_t cp;

	for (off = 0; off &lt; len; off += ret) {
		if ((ret = grapheme_decode_utf8(str + off,
		                                len - off, &amp;cp)) &gt; (len - off)) {
			/*
			 * string ended unexpectedly in the middle of a
			 * multibyte sequence and we have the choice
			 * here to possibly expand str by ret - len + off
			 * bytes to get a full sequence, but we just
			 * bail out in this case.
			 */
			break;
		}
		printf("%"PRIxLEAST32"\n", cp);
	}
}

void
print_cps_nul_terminated(const char *str)
{
	size_t ret, off;
	uint_least32_t cp;

	for (off = 0; (ret = grapheme_decode_utf8(str + off,
	                                          SIZE_MAX, &amp;cp)) &gt; 0 &amp;&amp;
	     cp != 0; off += ret) {
		printf("%"PRIxLEAST32"\n", cp);
	}
}
</code></pre>
<h1>SEE ALSO</h1>
<p>grapheme_encode_utf8(3),
libgrapheme(7)</p>
<h1>AUTHORS</h1>
<p>Laslo Hunhold (<a href="mailto:dev@frign.de">dev@frign.de</a>)</p>
<p>suckless.org - 2022-10-06</p>
</div>

</div>

</html>
