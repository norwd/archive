<!doctype html>
<html>
<head>
	<meta charset="utf-8"/>
	<title>dwm - dynamic window manager | suckless.org software that sucks less</title>
	<link rel="stylesheet" type="text/css" href="https://suckless.org/pub/style.css"/>
</head>

<div id="header">
	<a href="https://suckless.org/"><img src="https://suckless.org/logo.svg" alt=""/></a>&nbsp;
	<a id="headerLink" href="https://suckless.org/">suckless.org</a>
	<span class="hidden"> - </span>
	<span id="headerSubtitle">dwm - dynamic window manager</span>
</div>
<hr class="hidden"/>
<div id="menu">
	<a href="https://suckless.org/">home</a>
	<a href="../../index.html"><b>dwm</b></a>
	<a href="https://st.suckless.org/">st</a>
	<a href="https://core.suckless.org/">core</a>
	<a href="https://surf.suckless.org/">surf</a>
	<a href="https://tools.suckless.org/">tools</a>
	<a href="https://libs.suckless.org/">libs</a>
	<a href="https://ev.suckless.org/">e.V.</a>
	<span class="right">
		<a href="https://dl.suckless.org/">download</a>
		<a href="https://git.suckless.org/">source</a>
	</span>
</div>
<hr class="hidden"/>
<div id="content">
<div id="nav">
	<ul>
	<li><a href="../../index.html">about</a></li>
	<li><a href="../../customisation/index.html">customisation/</a></li>
	<li><a href="../../dynamic_window_management/index.html">dynamic window management/</a></li>
	<li><a href="../../faq/index.html">faq/</a></li>
	<li><a href="../../multi-monitor/index.html">multi monitor/</a></li>
	<li><a href="../../multi-pointer/index.html">multi pointer/</a></li>
	<li><a href="../../patches/index.html">patches/</a></li>
	<li><a href="../../screenshots/index.html">screenshots/</a></li>
	<li><a href="../index.html"><b>status monitor/</b></a>
		<ul>
		<li><a href="index.html"><b>email notifications/</b></a></li>
		</ul>
	</li>
	<li><a href="../../tutorial/index.html">tutorial/</a></li>
	</ul>
</div>
<hr class="hidden"/>
<div id="main">

<h1>email notifications</h1>
<h2>Description</h2>
<p>This init script is based on some ideas taken from the dwm ML. It adds email
notification using <code>fetchmail</code>. It also adds the functionality of showing the
content of the file <code>$HOME/.message</code> when it exists. This can be used for
displaying info by other programs writing to this file.</p>
<p>When a new email arrives a flashing text message is shown on the dwm's
status bar.</p>
<h2>Config .fetchmailrc</h2>
<p>This config works with GMail over IMAP with the IDLE extension for low bandwidth usage:</p>
<pre><code>poll imap.gmail.com port 993 proto IMAP user "&lt;your_user&gt;@gmail.com"
	there with password "&lt;your_pass&gt;" keep ssl idle
</code></pre>
<h2>Init script</h2>
<p>The notification is flashing during 60 seconds, then it is removed. Lines
written to <code>.message</code> are displayed during a second in the status bar. If
<code>.message</code> is deleted, the normal status message (date and uptime) returns.</p>
<p>A pipe must be used with <code>fetchmail</code> when using IDLE extension because this way
it waits for updates from the inbox not doing polling. If the <code>.message</code> file
exists with some content, it is preserved and no email notification is shown.</p>
<pre><code>fetchmail --check 2&gt;/dev/null | while read line; do
	new=`echo $line | sed 's/(//' | awk '{print $1-$3}'`
	if [ $new != 0 ] &amp;&amp; [ ! -e ~/.message ]; then
		echo "New mail($new)" &gt; ~/.message
		echo "!!! !!! !!!" &gt;&gt; ~/.message
		sleep 60
		if grep '^New mail' ~/.message &gt;/dev/null 2&gt;/dev/null; then
			rm -f ~/.message
		fi
	fi
done &amp;
while true; do
	if [ -r ~/.message ]; then
		while read line; do
			xsetroot -name "$line"
			sleep 1
		done &lt; ~/.message
	else
		xsetroot -name "`date` `uptime | sed 's/.*,//'`"
		sleep 1
	fi
done &amp;
exec dwm
rm -f ~/.message
</code></pre>
<h2>Author</h2>
<ul>
<li>Ricardo Catalinas Jim√©nez <a href="&#x6D;&#x61;i&#x6C;&#x74;&#x6F;:&#106;&#105;&#109;&#101;&#110;&#101;&#122;&#114;&#105;&#99;&#107;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;">&#106;&#105;&#109;&#101;&#110;&#101;&#122;&#114;&#105;&#99;&#107;&#64;&#103;&#109;&#97;&#105;&#108;&#46;&#99;&#111;&#109;</a></li>
</ul>
</div>

</div>

</html>
