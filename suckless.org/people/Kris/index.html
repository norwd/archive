<!doctype html>
<html>
<head>
	<meta charset="utf-8"/>
	<title>software that sucks less | suckless.org software that sucks less</title>
	<link rel="stylesheet" type="text/css" href="../../pub/style.css"/>
</head>

<div id="header">
	<a href="../../index.html"><img src="../../logo.svg" alt=""/></a>&nbsp;
	<a id="headerLink" href="../../index.html">suckless.org</a>
	<span class="hidden"> - </span>
	<span id="headerSubtitle">software that sucks less</span>
</div>
<hr class="hidden"/>
<div id="menu">
	<a href="../../index.html"><b>home</b></a>
	<a href="http://dwm.suckless.org/">dwm</a>
	<a href="http://st.suckless.org/">st</a>
	<a href="http://core.suckless.org/">core</a>
	<a href="http://surf.suckless.org/">surf</a>
	<a href="http://tools.suckless.org/">tools</a>
	<a href="http://libs.suckless.org/">libs</a>
	<a href="http://ev.suckless.org/">e.V.</a>
	<span class="right">
		<a href="http://dl.suckless.org/">download</a>
		<a href="http://git.suckless.org/">source</a>
	</span>
</div>
<hr class="hidden"/>
<div id="content">
<div id="nav">
	<ul>
	<li><a href="../../index.html">about</a></li>
	<li><a href="../../coding_style/index.html">coding style/</a></li>
	<li><a href="../../community/index.html">community/</a></li>
	<li><a href="../../conferences/index.html">conferences/</a></li>
	<li><a href="../../donations/index.html">donations/</a></li>
	<li><a href="../../faq/index.html">faq/</a></li>
	<li><a href="../../hacking/index.html">hacking/</a></li>
	<li><a href="../../other_projects/index.html">other projects/</a></li>
	<li><a href="../index.html"><b>people/</b></a>
		<ul>
		<li><a href="../20h/index.html">20h/</a></li>
		<li><a href="../FRIGN/index.html">FRIGN/</a></li>
		<li><a href="../Gottox/index.html">Gottox/</a></li>
		<li><a href="index.html"><b>Kris/</b></a></li>
		<li><a href="../Pancake/index.html">Pancake/</a></li>
		<li><a href="../Sin/index.html">Sin/</a></li>
		<li><a href="../Uriel/index.html">Uriel/</a></li>
		<li><a href="../cls/index.html">cls/</a></li>
		<li><a href="../drkhsh/index.html">drkhsh/</a></li>
		<li><a href="../garbeam/index.html">garbeam/</a></li>
		<li><a href="../hiltjo/index.html">hiltjo/</a></li>
		<li><a href="../k0ga/index.html">k0ga/</a></li>
		<li><a href="../maandree/index.html">maandree/</a></li>
		<li><a href="../more_people/index.html">more people/</a></li>
		<li><a href="../quinq/index.html">quinq/</a></li>
		<li><a href="../younix/index.html">younix/</a></li>
		</ul>
	</li>
	<li><a href="../../philosophy/index.html">philosophy/</a></li>
	<li><a href="../../project_ideas/index.html">project ideas/</a></li>
	<li><a href="../../rocks/index.html">rocks/</a></li>
	<li><a href="../../sucks/index.html">sucks/</a></li>
	<li><a href="../../wiki/index.html">wiki/</a></li>
	</ul>
</div>
<hr class="hidden"/>
<div id="main">

<h1>Kris Maglione aka JG</h1>
<p>I'm the maintainer of wmii.</p>
<p>This is a place for me to post the random scripts that I'm compelled to write and consider useful.</p>
<h2>Scripts</h2>
<p><em>Note:</em> I've updated most of these, and haven't posted the updates... I'll get around to it eventually.</p>
<p>All of these scripts are written in rc, and require plan9port to run.</p>
<ul>
<li><p>webpaste - A script which reads its standard input or the files
  on its command line and prints a URI where the data can be retrieved. Requires: curl.</p>
</li>
<li><p>pasteweb - Similar to webpaste, but reads the contents of your
 clipboard and replaces them with a URI where the contents can be retrieved.
 Requires: curl, and one of xclip, xsel, or sselp (in which case, it will print the URI)</p>
</li>
<li><p>plastfm - An rc script which connects to Last.FM and plays its stream with
 a command-line mp3 player. Commands are read from the standard input and song info is
 printed to the standard error. Requires: mpg123 or similar client. <em>This has been replaced
 by "last".</em></p>
</li>
<li><p>eris.rc - This is an IRC bot, written in rc, of course, which prints mercurial
 commits to channels. The name comes from George Neis' python version. Requires: sic or similar.</p>
</li>
<li><p>hgnotify.rc - This is an mailing list bot which posts mercurial commits
 along with their diffs to a mailing list, or arbitrary mailing address. The sender, subject,
 and date all reflect those of the commit. Requires: A sendmail compatible MTA.</p>
</li>
<li><p>logger.rc - A simple IRC logger bot, which uses the httplog logger to handle
 log rotation. It also extracts lines beginning with 'BUG' and writes them to a separate file.
 Requires: httplog, sic.</p>
</li>
</ul>
<h1><code>wmii</code> Scripts</h1>
<p>These are just some of the random wmii scripts I've written.
I find them immensely useful, and they serve as good examples.
Most use the <code>wmii.rc</code> script which I've written to make
<code>rc.wmii</code> more straightforward, and plugins easier. But, I haven't
released it yet, so bear with me.</p>
<h2><code>rc.keymap</code></h2>
<p>A simple keymap-changer applet. It doesn't know any keyboard
shortcuts for the moment.</p>
<pre><code>#!/bin/rc
. 9.rc
. wmii.rc keymap
</code></pre>
<pre><code># Begin Configuration
bar=s7~1keymap
choices=(us dvorak)
# End Configuration
</code></pre>
<pre><code>keymap=$choices(1)
</code></pre>
<pre><code>fn setkeymap {
    if(! ~ $"* '') {
        keymap=$"*
        setxkbmap $keymap
        echo km:$"keymap | wmiir create /rbar/$bar
    }
}
</code></pre>
<pre><code>setkeymap $keymap
</code></pre>
<pre><code>fn Event-RightBarMouseDown {
    if(! $1 1 &amp;&amp; ~ $2 $bar)
        setkeymap `{wi_9menu -initial $keymap $choices}
}
</code></pre>
<pre><code>wi_eventloop
</code></pre>
<h2><code>rc.vol</code></h2>
<p>Adjust the volume with Alt-Plus/Alt-Minus (should use <code>$MODKEY</code>...).
My first bar just happens to be named <code>agabaga</code>, because I picked
a random word which started with a ages ago, and the name stuck.</p>
<pre><code>#!/bin/rc
. 9.rc
. wmii.rc
</code></pre>
<pre><code># Begin Configuration
numbars = 20
mixer = pcm
bar = agabaga
delay = 2
# End Configuration
</code></pre>
<pre><code>fn mset {
    var=$1; shift
    eval $var' = `{hoc -e $"*}'
}
</code></pre>
<pre><code>mset div 100 / $numbars
</code></pre>
<pre><code>fn readvol { mixer $* | awk -F'[ :]+' '{print $7}' | head }
</code></pre>
<pre><code>xpid = ()
</code></pre>
<pre><code>fn changevol {
    diff = $1; shift
    cur = `{readvol $mixer}
    mset new $cur + '(' $diff ')'
</code></pre>
<pre><code>    mixer $mixer $new &gt;/dev/null
</code></pre>
<pre><code>    awk -vnew'='$new -vdiv'='$div -vn'='$numbars \
        'BEGIN{ s=sprintf("% *s", new/div, "|");
            gsub(/ /, "-", s);
            printf "[% -*s] %d%%", n, s, new;
            exit }' |
        wmiir write /rbar/$bar
</code></pre>
<pre><code>    /bin/kill $xpid &gt;[2]/dev/null # Let's hope this isn't reused...
    { sleep $delay; wmiir xwrite /rbar/$bar ' ' }&amp; # Bug...
    xpid = $apid
}
</code></pre>
<pre><code>fn Key-Mod1-^(KP_Add Shift-plus) {
    changevol $div
}
</code></pre>
<pre><code>fn Key-Mod1-^(KP_Subtract Shift-minus) {
    changevol -$div
}
</code></pre>
<pre><code>wi_eventloop
</code></pre>
<h2><code>rc.mail</code></h2>
<p>A mail monitor. I've posted it elsewhere. It reads the names of
windows on the mail tag and checks for mail in Maildirs with
corresponding names. It treats <code>inbox</code> specially. This is posted
elsewhere.</p>
<pre><code>#!/bin/rc
. 9.rc
</code></pre>
<pre><code># Configuration
#How often to check
delay=5
maildir=$home/Maildir
# End Configuration
</code></pre>
<pre><code>echo Start mail | wmiir write /event
</code></pre>
<pre><code>{   wmiir read /event &amp;
    while(echo Tick)
        sleep $delay
} | while(*=`{read}) 
    switch($1) {
    case Start
        if(~ $2 mail)
            exit
    case Tick
        wmiir read /tag/mail/index |
        while(l = `{read}) {
            b = `{echo $l | awk -F: '{print $3}'}
            if(~ $b inbox)
                b = ''
            if(! ~ $#b 0 &amp;&amp; test -d $maildir/.$b/new) {
                if(~ `{ls -l $maildir/.$b/new | wc -l} 0)
                    wmiir xwrite /client/$l(2)^/ctl Urgent off
                if not
                    wmiir xwrite /client/$l(2)^/ctl Urgent on
            }
        }
    }
</code></pre>
<h2><code>rc.status</code></h2>
<p>My date/time/load average bar. Straightforward.</p>
<pre><code>#!/bin/rc
. 9.rc
. wmii.rc rc.status
# periodically print date and load average to the bar
</code></pre>
<pre><code>fn date { /bin/date $* }
</code></pre>
<pre><code>bar_load=s5load
bar_date=s9date
bar_time=time
bars=($bar_date $bar_load)
</code></pre>
<pre><code>fn sigterm sigint {
    for(i in ($bars $bar_time))
        wmiir remove /rbar/$i &gt;[2]/dev/null
    exit
}
</code></pre>
<pre><code>for(i in $bars $bar_time)
    wmiir remove /rbar/$i &gt;[2]/dev/null
</code></pre>
<pre><code>sleep 2
for(i in $bars)
    echo -n $wmiinormcol | wmiir create /rbar/$i
echo -n $wmiifocuscol | wmiir create /rbar/$bar_time
</code></pre>
<pre><code>{
    while (wmiir xwrite /rbar/$bar_time `{date +'%H:%M:%S %Z'}
        &amp;&amp; wmiir xwrite /rbar/$bar_date  `{date +'%a, %e %b'}
        &amp;&amp; wmiir xwrite /rbar/$bar_load `{uptime | sed 's/.*://; s/,//g'})
        sleep 1
} &gt;[2]/dev/null
</code></pre>
<h2><code>rc.temp</code></h2>
<p>A temperature monitor for the bar. It has Fahrenheit along with
Celsius, because I'm stuck using both (tell someone in the US that
it's -3°C outside and expect little more than a blank stare).</p>
<p>This one uses weatherget. It's in ports... I don't know where else
to find it.</p>
<pre><code>#!/bin/rc
. 9.rc
</code></pre>
<pre><code># Begin Configuration
zip=12345 # For those outside the us, this needn't be a zip code.
bar=/rbar/s7temp
pidf=$home/.wmii-3.5/pid.temp
</code></pre>
<pre><code>deg=°
# End Configuration
</code></pre>
<pre><code>/usr/bin/kill `{cat $pidf} &gt;[2]/dev/null
echo $pid &gt;$pidf
</code></pre>
<pre><code>wmiir create $bar &lt;/dev/null
</code></pre>
<pre><code>while() {
    {weatherget -s $zip -m; weatherget -s $zip -S} |
        awk '$1=="Temperature"{print $3"'$deg'"$4}' |
        tr '\012' ' ' |
        wmiir create $bar ||
        exit
    sleep 600
}
</code></pre>
</div>

</div>

</html>
