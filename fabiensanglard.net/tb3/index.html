<html>
<head>
  <link rel="alternate" type="application/rss+xml"  title="RSS Feed for fabiensanglard.net" href="../rss.xml" />
  <style type="text/css">

    @font-face {
      font-family: 'fabfont';
      src: url('../font/DejaVuSansMono.woff2');
      font-display: block;
    }

    @font-face {
      font-family: 'fabfont';
      src: url('../font/DejaVuSansMono-Bold.woff2');
      font-weight: bold;
      font-display: block;
    }

    * {
       font-size: 16px;
    }

    html {
      font-family: fabfont,  monospace;
      max-width: 900px;  /* For Desktop PC (see @media for Tablets/Phones) */
      padding-left: 2%;
      padding-right: 3%;
      margin: 0 auto;
      background: #F5F5F0;
  	} 
    


  	a {
      color: black;
      font-weight: bold;
    }

    img {
      border: none; 
    }

    p {
      margin-top: 0px;
      text-align: justify;
    }
    sup {
      vertical-align: 0.3em;
      font-size: 0.65em;
    }   

    pre {
      font-family: fabfont, monospace;
      background-color: white; 
      border: 1px solid Black; 
      padding-left: 2%;
      padding-top: 1ch;
      padding-bottom: 1ch;
      /* Only take care of X overflow since this is the only part that can be too wide.
         The Y axis will never overflow.
      */
      overflow: hidden;
    }

    div.heading {
      font-weight: bold;      
      text-transform: uppercase;
      margin-top: 4ch;
    }

    /** {
      font-size: 16px;
    }*/
    @media (max-width: 500px) { /* For small screen decices */
      * {
        font-size: 12px; 
      }
    }   
    .title {
      text-decoration: none;
    }

    img.pixel, canvas.pixel {
      image-rendering: pixelated;
      image-rendering: -moz-crisp-edges;
      image-rendering: crisp-edges;
    }

    blockquote { 
    background-color: #f3f3f3;
    border: dashed 1px grey; 
    width: 97.5%; 
    font-style: italic; 
    text-align: justify;

    padding: 1ch; 
    padding-top: 2ch; 
    padding-bottom: 2ch;     
    
    margin : 0ch; 
    margin-bottom: 2ch; 
    margin-top: 0ch;
  }

  blockquote div {
    text-transform: none;
    text-align: right;
    width: 100%;
  }

  code {
    /*font-size: 110%;*/
    font-weight: bold;
    background-color: #e1e1e1;
    border-radius: 0.5ch;
    padding-left: 0.3ch;
    padding-right: 0.3ch;
  }

  .trivia {
    border-left: 1px black solid;
    padding-left: 1ch;
  }

  .trivia::before {
  font-weight: bold;
  text-decoration: underline;
  padding-right: 1ch;
  content: "Trivia:";

  </style>
  <title>The beautiful Silent ThunderBolt-3 PC</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=12.0, minimum-scale=1.0, user-scalable=yes">
</head>  
  <body><br><center>
    <div style="display: inline-block; vertical-align:middle;">
<a href="../index.html" class="title"><b>FABIEN SANGLARD'S WEBSITE</b><br>
</a><hr/><div style="text-align: justify;display: inline-block; width: 100%;">
<!-- <a class="title" href="/about/index.html">ABOUT</a> &nbsp;<a class="title" href="/contact/index.html">EMAIL</a> &nbsp;<a class="title" href="../rss.xml">RSS</a> &nbsp;<a class="title" href="https://paypal.me/fabiensanglard">DONATE</a></div></div> -->
<a class="title" href="../about/index.html">ABOUT</a> &nbsp;<a class="title" href="../contact/index.html">CONTACT</a> &nbsp;<a class="title" href="../rss.xml">RSS</a> &nbsp;<a class="title" href="https://paypal.me/fabiensanglard">GIVE</a></div></div>

</center><br><br>
<div style="margin-bottom: 2ch;text-transform: none;">
December 22, 2020</div>
<div class='heading'>The beautiful Silent ThunderBolt-3 PC</div><hr/><style type="text/css">
img {
  border: 1px black solid; 
}
</style>
<p>
When I placed the last screw on the DB4 chassis of the Beautiful Silent PC<a name="back_1" style="text-decoration: none;" href="index.html#footnote_1"><sup>[1]</sup></a>, I thought I would not have to open it up again for years. Perhaps, I hypothesized, it would be a decade before an upgrade.
<br/>
<img loading="lazy" src="done.webp" width="2315" height="1103" style="width: 100%; height: auto; margin-top: 2ch; margin-bottom: 1ch;"/><span style="text-align: center; display: block; margin-bottom: 2ch;"><i><small>The beautiful silent PC.</small></i></span>
The imperative of working from home proved me wrong when the seemingly easy problem of sharing peripherals between a desktop and a laptop turned out to be more complicated than expected. It had the positive outcome of teaching me about the marvelous world of cables, USB, DisplayPort, DisplayLink and Thunderbolt.  
<br/>

</p>















<div class='heading'>USB can't</div><hr/><p>
My first solution was based on a USB stack with a USB 3 hub supporting 4k60Hz over DisplayPort. Plenty of such devices are advertised on Amazon.
<br/>
<img loading="lazy" src="usb.svg" width="612.51044mm" height="291.83542mm" style="width: 100%; height: auto; margin-top: 2ch; margin-bottom: 1ch; background-color:white;"/><span style="text-align: center; display: block; margin-bottom: 2ch;"><i><small>USB solution.</small></i></span>
Sadly it turned out that USB 3.1 and Display Port 1.2 hardware could not do that. As Steve Chamberlin detailed<a name="back_2" style="text-decoration: none;" href="index.html#footnote_2"><sup>[2]</sup></a>, there is just not enough bandwidth. The best one can hope for while relying soly on USB is 4k30Hz with 3.1 ports, 4k60Hz with 2.0 ports, or an exotic hub that will use compression via DisplayLink.
<br/>
<br/>
Steve's article mentioned how DP 1.4's DSC would help but none of my hardware supported it. Ditto USB-4.
The workaround was a less elegant system of two cables per machine with one to drive the monitor and one for the peripherals.<br/>

<img loading="lazy" src="usb-2cables.svg" width="612.51044mm" height="291.83542mm" style="width: 100%; height: auto; margin-top: 2ch; margin-bottom: 1ch; background-color:white;"/><span style="text-align: center; display: block; margin-bottom: 2ch;"><i><small>USB with two cables per machine.</small></i></span>
 It kind of worked but with sporadic issues such as refusal to wake up when typing on the keyboard. Other times the same Ergodox EZ would find itself inexplicably unpowered. At that point it became painfully obvious that USB hub quality varied greatly. If I was going to spend more on a quality hub, why not take it to the next level?
<br/>
</p>


<div class='heading'>ThunderBolt-3 does</div><hr/><p>
   According to Steve's article, Thunderbolt-3 can provide display, power, and peripherals on a single cable. I looked for hubs supporting 4k60 and USB-3 and read many good things about the CalDigit TS3 Plus. All I had to do was to find an ITX motherboard with Thunderbolt-3 capability.
<br/>
<img loading="lazy" src="tb3.svg" width="612.51044mm" height="291.83542mm" style="width: 100%; height: auto; margin-top: 2ch; margin-bottom: 1ch; background-color:white;"/><span style="text-align: center; display: block; margin-bottom: 2ch;"><i><small>Thunderbolt-3 solution<a name="back_3" style="text-decoration: none;" href="index.html#footnote_3"><sup>[3]</sup></a>.</small></i></span>
There was only one motherboard on the market to fit the bill, the X570 Phantom Gaming-ITX/TB3<a name="back_4" style="text-decoration: none;" href="index.html#footnote_4"><sup>[4]</sup></a> by ASRock. 
<br/>
</p>

<div class='heading'>Road to Thunderbolt-3</div><hr/><p>
	The Phantom Gaming ITX TB-3 has massive heat-sinks. The Southbridge even has a dedicated fan with a heat pipe (left of CPU). There is a secondary huge heat-sink with yet-to-be-determined purpose on the right of the CPU socket<a name="back_5" style="text-decoration: none;" href="index.html#footnote_5"><sup>[5]</sup></a>.<br/> 
	<img loading="lazy" src="close_up.webp" width="1794" height="980" style="width: 100%; height: auto; margin-top: 2ch; margin-bottom: 1ch;"/><span style="text-align: center; display: block; margin-bottom: 2ch;"><i><small>The Southbridge chip (left of CPU) is HUGE. It even has its own fan and heat pipe.</small></i></span>

The consequences of these radiators is that there is not enough clearance for the 105W capable LH6 heat pipes. The standard SH6 providing 65W dissipation were used instead.<br/>  
	<img loading="lazy" src="sh6.webp" width="1794" height="1185" style="width: 100%; height: auto; margin-top: 2ch; margin-bottom: 1ch;"/><span style="text-align: center; display: block; margin-bottom: 2ch;"><i><small>Not enough clearance for the enhanced LH6 pipes. The SH6 will have to do the job.</small></i></span>

	Funky cables are involved in this build. The 2m (6ft) Thunderbolt-3 must be active in order to be 40Gb/s capable. Another weirdness is the 1 foot DP to DP cable required to connect the GPU DP-output to the Mobo DP-input. This is required to get the video stream on the Thunderbolt port. No doubt it will bring warm memories to those who had to do the same thing with VGA pass-through on their 3dFX.<br/>
	<img loading="lazy" src="cables.webp" width="1374" height="631" style="width: 100%; height: auto; margin-top: 2ch; margin-bottom: 1ch;"/><span style="text-align: center; display: block; margin-bottom: 2ch;"><i><small>One foot DP-DP cable and six foot active Thunderbolt-3 cable.</small></i></span>
</p>

<div class='heading'>Thermals</div><hr/><p>
	Going from 105W to 65W dissipation was a concern. Pinning all 12 cores for 15mn showed a steady increase whereas 10 cores were stable around 7X<sup style="font-weight: bold;">o</sup>C. Combined to the temperature cliff once load diminishes, I don't expect to see any throttling.<br/>   
	<img loading="lazy" src="cpu.png" width="1309" height="264" style="width: 100%; height: auto; margin-top: 2ch; margin-bottom: 1ch;"/><span style="text-align: center; display: block; margin-bottom: 2ch;"><i><small>CPU thermals with 12 cores pinned down.</small></i></span>
<div style="float:right;margin-left: 2ch; width: 15%; height: auto;">
	<img loading="lazy" src="side_view.webp" width="467" height="623" style="width: 100%; height: auto; margin-bottom:1ch;border: 0;"/>   	<span style="text-align: center; display: block; margin-bottom: 1ch;"><i><small>CalDigit TB3 side</small></i></span>
</div>  
<p>

A new thermal sensor appeared in HWiNFO64.EXE. SB, standing for "SouthBridge", seems to be doing a lot regardless of the load on the CPU or GPU. This component stabilizes at 75<sup style="font-weight: bold;">o</sup>C which, at rest, is the hottest component in the machine (CPU = 37<sup style="font-weight: bold;">o</sup>C, GPU = 39<sup style="font-weight: bold;">o</sup>C, and Mobo = 46<sup style="font-weight: bold;">o</sup>C).  Even actively cooled build see the same kind of numbers so it does not look like the DB4 is at fault here.
<br/>
<br/>
Seeing such temperature on an IO chipset was a total surprise. But observing Caldigit TB3's large heat-sink makes me wonder if performing Thunderbolt-3 IO is simply just an order of magnitude more intensive than USB 3.2. Maybe ASRock motherboard is doing the best it can. But if that is the case, how does Apple cools down its fanless laptop? 
<br/>

<img loading="lazy" src="sb.png" width="1309" height="264" style="width: 100%; height: auto; margin-top: 2ch; margin-bottom: 1ch;"/><span style="text-align: center; display: block; margin-bottom: 2ch;"><i><small>Southbridge chipset thermals.</small></i></span>

That chipset has a fan which does not play along with the fan-less-ness of the machine. Surprisingly, running it at 100% or disabling it with a "FAN-Tastic-Tuning" custom policy does not change the operating temperature. Setting the threshold to 80<sup style="font-weight: bold;">o</sup> is a bold move but that is how you get where no one has gone before. With this setting, I have never heard the fan run.<br/>
<img loading="lazy" src="PGT.webp" width="1500" height="973" style="width: 100%; height: auto; margin-top: 2ch; margin-bottom: 1ch;"/><span style="text-align: center; display: block; margin-bottom: 2ch;"><i><small>Modern tools allow for designing your own fan strategy.</small></i></span>
</p>
<div class='heading'>Result</div><hr/><p>
	The BSTB3-PC is definitely on the edge of the DB4 thermal frontier but it works reliably. I have been using it to browse the web, write this article, VC, program, and <strike>play</strike> lose at Starcraft 2 without issues so far.<br/>
<img loading="lazy" src="result.webp" width="2345" height="1340" style="width: 100%; height: auto; margin-top: 2ch; margin-bottom: 1ch;"/><span style="text-align: center; display: block; margin-bottom: 2ch;"><i><small>The Beautiful Thunderbolt-3 Silent PC</small></i></span>
Besides requiring a single cable, Thunderbolt-3 quadrupled the USB 3.1 bandwidth I was used to which was appreciable when transferring large amount of photos from my DSLR.<br/>
<img loading="lazy" src="speed_path.svg" width="285.92471mm" height="91.520851mm" style="width: 100%; height: auto; margin-top: 2ch; margin-bottom: 1ch;background-color: white;"/><span style="text-align: center; display: block; margin-bottom: 2ch;"><i><small>Even the latest USB (3.2) is twice as slow as Thunderbolt-3.</small></i></span>


Ironically, as I finished putting it together, Apple announced a fanless M1 Macbook Air which would have performed just as well, if not better. Nonetheless, I am proud of the result. It is a damn good looking silent computer. And this one is "Designed in Sunnyvale" baby!<br/>
</p>
<style type='text/css'>td.ref {  padding-bottom: 0ch; width:0;}</style><div class='heading'>References</div><hr/><p id='paperbox' style='text-align:left;'><table><tbody style='vertical-align: top;'><tr><td class='ref' style='width:1ch;'><a name="footnote_1"></a><a href="index.html#back_1">^</a></td><td  class='ref' style='width:4ch;'> [1]</td><td style='width:100%;text-align:left;' class='ref'><a href="../the_beautiful_machine/index.html">The Beautiful Silent PC</a></td></tr><tr><td class='ref' style='width:1ch;'><a name="footnote_2"></a><a href="index.html#back_2">^</a></td><td  class='ref' style='width:4ch;'> [2]</td><td style='width:100%;text-align:left;' class='ref'><a href="https://www.bigmessowires.com/2019/05/19/explaining-4k-60hz-video-through-usb-c-hub/">Explaining 4K 60Hz Video Through USB-C Hub</a></td></tr><tr><td class='ref' style='width:1ch;'><a name="footnote_3"></a><a href="index.html#back_3">^</a></td><td  class='ref' style='width:4ch;'> [3]</td><td style='width:100%;text-align:left;' class='ref'><a href="https://news.ycombinator.com/item?id=25517804">The two TB3 cables are swapped via magnetic adapters</a></td></tr><tr><td class='ref' style='width:1ch;'><a name="footnote_4"></a><a href="index.html#back_4">^</a></td><td  class='ref' style='width:4ch;'> [4]</td><td style='width:100%;text-align:left;' class='ref'><a href="https://www.asrock.com/mb/AMD/X570%20Phantom%20Gaming-ITXTB3/index.asp">X570 Phantom Gaming-ITX/TB3</a></td></tr><tr><td class='ref' style='width:1ch;'><a name="footnote_5"></a><a href="index.html#back_5">^</a></td><td  class='ref' style='width:4ch;'> [5]</td><td style='width:100%;text-align:left;' class='ref'><a href="https://news.ycombinator.com/item?id=25519496">This sink turned out to be the VMR (Voltage Regulator Module)</a></td></tr></tbody></table></p> <hr>
 <center>*