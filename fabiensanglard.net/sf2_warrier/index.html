<html>
<head>
  <link rel="alternate" type="application/rss+xml"  title="RSS Feed for fabiensanglard.net" href="../rss.xml" />
  <style type="text/css">

    @font-face {
      font-family: 'fabfont';
      src: url('../font/DejaVuSansMono.woff2');
      font-display: block;
    }

    @font-face {
      font-family: 'fabfont';
      src: url('../font/DejaVuSansMono-Bold.woff2');
      font-weight: bold;
      font-display: block;
    }

    * {
       font-size: 16px;
    }

    html {
      font-family: fabfont,  monospace;
      max-width: 900px;  /* For Desktop PC (see @media for Tablets/Phones) */
      padding-left: 2%;
      padding-right: 3%;
      margin: 0 auto;
      background: #F5F5F0;
  	} 
    


  	a {
      color: black;
      font-weight: bold;
    }

    img {
      border: none; 
    }

    p {
      margin-top: 0px;
      text-align: justify;
    }
    sup {
      vertical-align: 0.3em;
      font-size: 0.65em;
    }   

    pre {
      font-family: fabfont, monospace;
      background-color: white; 
      border: 1px solid Black; 
      padding-left: 2%;
      padding-top: 1ch;
      padding-bottom: 1ch;
      /* Only take care of X overflow since this is the only part that can be too wide.
         The Y axis will never overflow.
      */
      overflow: hidden;
    }

    div.heading {
      font-weight: bold;      
      text-transform: uppercase;
      margin-top: 4ch;
    }

    /** {
      font-size: 16px;
    }*/
    @media (max-width: 500px) { /* For small screen decices */
      * {
        font-size: 12px; 
      }
    }   
    .title {
      text-decoration: none;
    }

    img.pixel, canvas.pixel {
      image-rendering: pixelated;
      image-rendering: -moz-crisp-edges;
      image-rendering: crisp-edges;
    }

    blockquote { 
    background-color: #f3f3f3;
    border: dashed 1px grey; 
    width: 97.5%; 
    font-style: italic; 
    text-align: justify;

    padding: 1ch; 
    padding-top: 2ch; 
    padding-bottom: 2ch;     
    
    margin : 0ch; 
    margin-bottom: 2ch; 
    margin-top: 0ch;
  }

  blockquote div {
    text-transform: none;
    text-align: right;
    width: 100%;
  }

  code {
    /*font-size: 110%;*/
    font-weight: bold;
    background-color: #e1e1e1;
    border-radius: 0.5ch;
    padding-left: 0.3ch;
    padding-right: 0.3ch;
  }

  .trivia {
    border-left: 1px black solid;
    padding-left: 1ch;
  }

  .trivia::before {
  font-weight: bold;
  text-decoration: underline;
  padding-right: 1ch;
  content: "Trivia:";

  </style>
  <title>Street Fighter II, The World Warrier</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=12.0, minimum-scale=1.0, user-scalable=yes">
</head>  
  <body><br><center>
    <div style="display: inline-block; vertical-align:middle;">
<a href="../index.html" class="title"><b>FABIEN SANGLARD'S WEBSITE</b><br>
</a><hr/><div style="text-align: justify;display: inline-block; width: 100%;">
<!-- <a class="title" href="/about/index.html">ABOUT</a> &nbsp;<a class="title" href="/contact/index.html">EMAIL</a> &nbsp;<a class="title" href="../rss.xml">RSS</a> &nbsp;<a class="title" href="https://paypal.me/fabiensanglard">DONATE</a></div></div> -->
<a class="title" href="../about/index.html">ABOUT</a> &nbsp;<a class="title" href="../contact/index.html">CONTACT</a> &nbsp;<a class="title" href="../rss.xml">RSS</a> &nbsp;<a class="title" href="https://paypal.me/fabiensanglard">GIVE</a></div></div>

</center><br><br>
<div style="margin-bottom: 2ch;text-transform: none;">
Dec 23, 2021</div>
<div class='heading'>Street Fighter II, The World Warrier</div><hr/><style type="text/css">

img {
    border: 1px black solid;
}

code {
    /*font-size: 110%;*/
    font-weight: bold;
    background-color: #e1e1e1;
    border-radius: 0.5ch;
    padding-left: 0.3ch;
    padding-right: 0.3ch;
}

.center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

td { 
    padding-bottom: 4%;
}

table td.crossed
{
   background-image: linear-gradient(to bottom right,  transparent calc(50% - 0.5px), black, transparent calc(50% + 0.5px)); 
}

</style>
  

<p>
    <i>This article is part of a <a href="../sf2_sheets/index.html">series</a> about Street Fighter II and the CPS-1. It is recommended to read the previous entries before reading this one.</i>
</p>

<div class='heading'>The embarassing typo</div><hr/><p>
    One of my favorite anecdote about Street Fighter II is Akiman's account of an issue discovered shortly before shipping.
    <blockquote>
    Just three days before the deadline, I discovered something horrible. I had made a mistake with the subtitle “World Warrior”, mis-spelling it “World Warrier.”<br/>
<br/>
<div>- Akiman, Lead graphic design on SF2 (translated by Shmuplation)</div>
</blockquote>
</p>
<img loading="lazy" src="sf2_title_warrier.webp" class="pixel center" style="width: 100%;width:100%; aspect-ratio: 4 / 3;   margin-bottom: 1ch;"/><span style="text-align: center; display: block; margin-bottom: 2ch;"><i><small>A recreation of the problem. Ouch!</small></i></span>

<p>
  To fully understand the issue, we need to dig into how the arcade hardware works. The CPS-1 is a super tile drawing machine. It can draw a lot of tiles but cannot alter them. They are taken from the GFX ROM as they are and sent to the screen (although they can be flipped horizontally or vertically).
</p>
  <p>
  The GFX ROM and the 68000 instructions ROM as burned separately. The problem Akiman describe is that the GFX ROM had been burned but he could still make changes to the instructions.
</p>
<p>
  But how could he fix the mistake if the artwork was set in stone at this point?
</p>

<blockquote>
    Now I can safely tell this story too, but we actually didn’t discover it until several months after all the sprite work had been done. Since the logo had already been created, I couldn’t just go in and change the letter at this point.<br/>
    <br/>
    "Maybe I can just force it to look like an ‘o’," I thought. I tried layering various other sprites over it until finally, it looked like an ‘o’. Phew!
<br/>
<br/>
<div>- Akiman, Lead graphic design on SF2 (translated by Shmuplation)</div>
</blockquote>


<div class='heading'>All about details</div><hr/><p>
    Akiman description of the solution left me wanting more details. How did he turn an 'e' into an 'o'? Since I had a sheet extractor, I looked for the text and sure enough, the logo and the typo were found on sheet <code>0x7B00</code>.
</p>
<img loading="lazy" src="0x7b00.svg" class="pixel center" width="133.98253pt" height="136.40675pt" style="width: 50%; height: auto; margin-bottom: 2ch;border:none;"/><p>
    The logo is drawn via 16 draw calls using tiles <code>0xC8</code>, <code>0xC9</code>, <code>0xCA</code>, <code>0xCB</code>, <code>0xCC</code>, <code>0xCD</code>, <code>0xCE</code>, <code>0xCF</code>, <code>0xD8</code>, <code>0xD9</code>, <code>0xDA</code>, <code>0xDB</code>, <code>0xDC</code>, <code>0xDD</code>, <code>0xDE</code>, and <code>0xDF</code>.
</p>
<img loading="lazy" src="worldwarrier_tile.svg" class="pixel" width="67.774017mm" height="4.4297466mm" style="width: 100%; height: auto; margin-bottom: 2ch; border:none;"/> 
<p>
    The way Akiman solved his problem show that you have to be practical in order to ship. He noticed that there was an 'or' in 'World' which would kinda fit in place of the 'ier'. So, he dropped the three last tiles <code>0xDD</code>, <code>0xDE</code>, and <code>0xDF</code> and replaced them with <code>0xCD</code> and <code>0xCE</code>.
</p>
<img loading="lazy" src="world_warrWor.svg" class="pixel" width="67.774017mm" height="4.4297466mm" style="width: 100%; height: auto; margin-bottom: 2ch; border:none;"/><p>
     That was better but it only displaced the problem since the borrowed right leg of the 'W' looked like an 'l' instead of an 'i'. The logo now read 'The World Warrlor'.
</p>
<p>At this point, what was needed was a way to slice the top of the 'l' to make it look like a dot on top of an 'i' but how could he do that since the 68000 cannot write in a tile?
  </p>

<div class='heading'>Guile to the rescue</div><hr/><p>
    The last part of the puzzle comes from Guile's calves. If you look closely at tile <code>0x96</code> you will notice that it has only one pixel visible in the lower left corner.
</p>
<img loading="lazy" src="0x7700.svg" class="pixel center" width="133.98253pt" height="136.40675pt" style="width: 50%; height: auto; margin-bottom: 2ch;border:none;"/>
<p>
    
    



  <table style="float:right; margin-left:2ch; width:28%;">
   <tr><td>



    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse:collapse;">
      <tbody><tr>
           <td class="t" style="background-color: #664400FF">&nbsp;</td>
    <td class="t" style="background-color: #ffffffFF">&nbsp;</td>
    <td class="t" style="background-color: #ffdd99FF">&nbsp;</td>
    <td class="t" style="background-color: #ffbb88FF">&nbsp;</td>
    <td class="t" style="background-color: #ee9977FF">&nbsp;</td>
    <td class="t" style="background-color: #bb7755FF">&nbsp;</td>
    <td class="t" style="background-color: #ddffaaFF">&nbsp;</td>
    <td class="t" style="background-color: #88dd99FF">&nbsp;</td>
    </tr>
  <tr>
  <td class="t" style="background-color: #669977FF">&nbsp;</td>
    <td class="t" style="background-color: #447744FF">&nbsp;</td>
    <td class="t" style="background-color: #ff5500FF">&nbsp;</td>
    <td class="t" style="background-color: #0077ddFF">&nbsp;</td>
    <td class="t" style="background-color: #ffee00FF">&nbsp;</td>
    <td class="t" style="background-color: #996644FF">&nbsp;</td>
    <td class="t" style="background-color: #005500FF">&nbsp;</td>
          <td class="t crossed">&nbsp;</td>
      </tr>
    </tbody>
    </table>

</td><tr><td>

<span style="text-align: center; display: block; margin-bottom: 2ch;"><i><small>Guile palette</small></i></span>
  </div>

</td></tr><tr><td>
 
   
<table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse:collapse;"><tbody><tr>
<td class="t" style="background-color: #111111FF">&nbsp;</td>
    <td class="t" style="background-color: #55aaffFF">&nbsp;</td>
    <td class="t" style="background-color: #66bbffFF">&nbsp;</td>
    <td class="t" style="background-color: #88ccffFF">&nbsp;</td>
    <td class="t" style="background-color: #aaddffFF">&nbsp;</td>
    <td class="t" style="background-color: #cceeffFF">&nbsp;</td>
    <td class="t" style="background-color: #eeeeffFF">&nbsp;</td>
    <td class="t" style="background-color: #000000FF">&nbsp;</td>
    </tr>
  <tr>
  <td class="t" style="background-color: #000000FF">&nbsp;</td>
    <td class="t" style="background-color: #000000FF">&nbsp;</td>
    <td class="t" style="background-color: #000000FF">&nbsp;</td>
    <td class="t" style="background-color: #000000FF">&nbsp;</td>
    <td class="t" style="background-color: #000000FF">&nbsp;</td>
    <td class="t" style="background-color: #000000FF">&nbsp;</td>
    <td class="t" style="background-color: #1111ddFF">&nbsp;</td>
    <td class="t crossed">&nbsp;</td>
</tr></tbody></table>
</td></tr>
<tr><td>
<span style="text-align: center; display: block; margin-bottom: 2ch;"><i><small>World Warrier palette</small></i></span>

</td></tr>
  </table>

<p>Something that I omitted to mention earlier is that the palette management is entirely under the 68000 control. The CPU is free to issue a tile drawing command using whatever palette it pleases.
</p>
<p>
Guile's green palette is not useful since the logo uses blue colors. But if we place them side by side, we notice that index <code>14</code> is dark green in Guile's palette but dark blue in the logo palette. 
</p>
<p>
Using tile <code>0x96</code> with the logo palette allows the 68000 to have a (very expensive) system where 255 pixels are wasted to transparency but the 256th can be used like a pencil.
</p>



<p>
    That pencil-tile is used to issue three draw command with coordinates overlapping the 'l'. This effectively creates a line which cuts the top part and make it look like the dot at the top of an 'i'. 
</p>
    <img loading="lazy" src="world_warrior_title.svg" class="pixel" width="67.798981mm" height="7.5145645mm" style="width: 100%; height: auto; margin-bottom: 2ch; border:none;"/><p>
    If you ever wondered why the 'i' of 'Warrior' looked weird all these years, now you know.
</p>
    <img loading="lazy" src="sf2_title.webp" class="pixel center" style="width: 100%;margin-bottom: 1ch;width:100%; aspect-ratio: 4 / 3;"/>    <span style="text-align: center; display: block; margin-bottom: 2ch;"><i><small>Et voila!</small></i></span>
</p>


<div class='heading'>Epilogue</div><hr/><p>
  The typo was fixed in later versions of Street Fighter 2 where the "World Warrior" set of tiles features a proper "IOR".
</p>
<img loading="lazy" src="sfhf-0x7b00.svg" class="pixel center" width="133.98253pt" height="136.40675pt" style="width: 50%; height: auto; margin-bottom: 2ch;border:none;"/><p>
   Ironically these are not used since the sub-title was changed from "World Warrior" to "Champion Edition" and then "Hyper-fighting".
 </p> <hr>
 <center>*