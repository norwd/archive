<html>
<head>
  <link rel="alternate" type="application/rss+xml"  title="RSS Feed for fabiensanglard.net" href="../rss.xml" />
  <style type="text/css">

    @font-face {
      font-family: 'fabfont';
      src: url('../font/DejaVuSansMono.woff2');
      font-display: block;
    }

    @font-face {
      font-family: 'fabfont';
      src: url('../font/DejaVuSansMono-Bold.woff2');
      font-weight: bold;
      font-display: block;
    }

    * {
       font-size: 16px;
    }

    html {
      font-family: fabfont,  monospace;
      max-width: 900px;  /* For Desktop PC (see @media for Tablets/Phones) */
      padding-left: 2%;
      padding-right: 3%;
      margin: 0 auto;
      background: #F5F5F0;
  	} 
    


  	a {
      color: black;
      font-weight: bold;
    }

    img {
      border: none; 
    }

    p {
      margin-top: 0px;
      text-align: justify;
    }
    sup {
      vertical-align: 0.3em;
      font-size: 0.65em;
    }   

    pre {
      font-family: fabfont, monospace;
      background-color: white; 
      border: 1px solid Black; 
      padding-left: 2%;
      padding-top: 1ch;
      padding-bottom: 1ch;
      /* Only take care of X overflow since this is the only part that can be too wide.
         The Y axis will never overflow.
      */
      overflow: hidden;
    }

    div.heading {
      font-weight: bold;      
      text-transform: uppercase;
      margin-top: 4ch;
    }

    /** {
      font-size: 16px;
    }*/
    @media (max-width: 500px) { /* For small screen decices */
      * {
        font-size: 12px; 
      }
    }   
    .title {
      text-decoration: none;
    }

    img.pixel, canvas.pixel {
      image-rendering: pixelated;
      image-rendering: -moz-crisp-edges;
      image-rendering: crisp-edges;
    }

    blockquote { 
    background-color: #f3f3f3;
    border: dashed 1px grey; 
    width: 97.5%; 
    font-style: italic; 
    text-align: justify;

    padding: 1ch; 
    padding-top: 2ch; 
    padding-bottom: 2ch;     
    
    margin : 0ch; 
    margin-bottom: 2ch; 
    margin-top: 0ch;
  }

  blockquote div {
    text-transform: none;
    text-align: right;
    width: 100%;
  }

  code {
    /*font-size: 110%;*/
    font-weight: bold;
    background-color: #e1e1e1;
    border-radius: 0.5ch;
    padding-left: 0.3ch;
    padding-right: 0.3ch;
  }

  .trivia {
    border-left: 1px black solid;
    padding-left: 1ch;
  }

  .trivia::before {
  font-weight: bold;
  text-decoration: underline;
  padding-right: 1ch;
  content: "Trivia:";

  </style>
  <title>The polygons of DOOM: PSX</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=12.0, minimum-scale=1.0, user-scalable=yes">
</head>  
  <body><br><center>
    <div style="display: inline-block; vertical-align:middle;">
<a href="../index.html" class="title"><b>FABIEN SANGLARD'S WEBSITE</b><br>
</a><hr/><div style="text-align: justify;display: inline-block; width: 100%;">
<!-- <a class="title" href="/about/index.html">ABOUT</a> &nbsp;<a class="title" href="/contact/index.html">EMAIL</a> &nbsp;<a class="title" href="../rss.xml">RSS</a> &nbsp;<a class="title" href="https://paypal.me/fabiensanglard">DONATE</a></div></div> -->
<a class="title" href="../about/index.html">ABOUT</a> &nbsp;<a class="title" href="../contact/index.html">CONTACT</a> &nbsp;<a class="title" href="../rss.xml">RSS</a> &nbsp;<a class="title" href="https://paypal.me/fabiensanglard">GIVE</a></div></div>

</center><br><br>
<div style="margin-bottom: 2ch;text-transform: none;">
March 26, 2020</div>
<div class='heading'>The polygons of DOOM: PSX</div><hr/>
<p>
  It was a pleasure to research the material for the "Polygons of Another World" articles<a name="back_1" style="text-decoration: none;" href="index.html#footnote_1"><sup>[1]</sup></a>. All the machines I studied were different from one another. The diversity I witnessed in the Amiga, Atari ST, PC, SNES, Genesis, GBA, and Jaguar demonstrated the richness of a field then still in its dawn.
<br/><br/>
   As I concluded the series, I regretted not being able to take a look at one mythical console of the mid-90s, the Sony PlayStation. I had the opportunity to touch upon it when I was writing the <i>Game Engine Black Book: DOOM</i><a name="back_2" style="text-decoration: none;" href="index.html#footnote_2"><sup>[2]</sup></a> two years ago but I wanted to go deeper. My curiosity was so great that I decided to relax my rules and use DOOM instead of Another World at a pretext to dig in.
</p> 


<div class='heading'>Sony PlayStation</div><hr/><p style="margin-bottom:1ch;">
<img loading="lazy" src="Playstation_logo_colour.svg" width="134.24748" height="101.99763" style="width: 24%; height: auto; float:right;margin-left: 2ch; margin-bottom: 1ch;"/>The history of the PlayStation started in 1988 when Nintendo
collaborated with Sony to produce a CD-ROM reader add-on
for the SNES. Under the terms of the contract, Sony could
develop independently for the platform and retained control
over the "Super Disc" format – two unusual concessions on
Nintendo’s part.
<br/><br/>
The project moved forward until CES ’91 when Sony announced the joint venture called "Play Station". The next day, during the same event, Nintendo announced it had instead partnered with Philips (with much more advantageous terms) much to Sony’s surprise. Betrayed and publicly humiliated, Sony attempted to turn
to Sega’s Board of Directors who promptly vetoed the idea. In a 2013 interview then-SEGA CEO Tom Kalinske remembered the board’s conclusion at the time.
<br/><br/>
<blockquote>
	That’s a stupid idea, Sony doesn’t know how to make hardware. They don’t know how to make software either. Why would we want to do this?
<br/>
<br/>
	<div>- SEGA Board</div>
</blockquote>
<p>
They were not wrong. Sony had little experience with gaming. It also had almost no interest in trying either since most of its involvement so far had relied on one man, Ken Kutaragi. Ever since he had witnessed his daughter play on a Nintendo Famicom, Ken had been advocating for Sony to enter the market. He had even designed Nintendo’s audio chip (the SPC700) for their SNES against the advice of Sony VPs.
<br/><br/>
Despite being considered a risky gamble by other Sony executives, Kutaragi gained the support of Sony CEO Norio Ohga. In June 1992 Ken got the green light to build a gaming system from scratch. The "Father of the PlayStation" as he would later be called had to be transfered to the financially separate Sony Music to appease the board but he could set himself to work on what would become the "PlayStation" (without space).
<br/><br/>
There was originally some uncertainty about the architecture which could focus either on 2D sprite graphics or 3D polygon graphics. The success of Sega’s Oct 1993 Virtua Fighter in Japanese arcades cleared all doubts: the PSX was going the 3D route.
<br/><br/>
The project culminated two years later with the creation of Sony Computer Entertainment and a Japanese release on December 3, 1994. It was an instant success selling 100,000 units on day one, 2 million after six months, and 102 million units over its lifetime.<br/>
<picture>
  <source srcset="psx.webp" type="image/webp"> 
  <img loading="lazy" src="psx.jpg" width="1024" height="470" style="width: 100%; height: auto; margin-top: 2ch; margin-bottom: 1ch;border: 1px black solid;"/></picture>
<span style="text-align: center; display: block; margin-bottom: 2ch;"><i><small>The Sony PSX (aka PS1, aka PlayStation). Photo Credit: Wikipedia</small></i></span>
</p>

<div class='heading'>Architecture</div><hr/><p>
	<img src="psx_arch.svg" style="width: 60%;float:right; margin-left: 2ch; margin-bottom: 1ch; border: 1px black solid;"/>
At the heart of the machine, we find a 32-bit RISC R3000A from MIPS clocked at 33.8688 MHz<a name="back_3" style="text-decoration: none;" href="index.html#footnote_3"><sup>[3]</sup></a> combined to 2 MiB of DRAM. Noteworthy, this chip also feature a Motion Decoder (MDEC) to allow playback of video in 320x240 at 30fps. Next to the MDEC we find a Geometry Transform Engine (GTE) co-processor carved to perform fast fixed-point math operations on vectors and matrices. The whole system has no floating-point capability.
<br/><br/>
The GPU is a black box to be piloted by the CPU via "commands". It features 1 MiB of VRAM which is not addressable by the CPU. It works a lot like the venerable OpenGL Immediate mode by drawing textured polygons which can be "shaded" via vertex color. The pipeline is fixed and not programmable. There is no Z-Buffer.
<br/><br/>
The Sound Processing Unit (SPU) is, like the GPU, a black box. Capable of handling 24 channels, it has 512 KiB of SRAM to store audio (as ADPCM) and can mix CD-ROM audio track on its voices. The acronym SRAM does not mean "Static RAM" but "Sound RAM".
<br/><br/>
The most audacious decision from Sony designers was about the storage medium. There are no cartridges but rather a double speed CD-ROM unit which lowered game prices and improved capacity tremendously to near 650MiB. The drawbacks were a low transfer speed (300KiB/s) and an abysmal seek time (300ms).
<br/><br/>
There is no Blitter. The machine programming model was to keep developers away from the metal. There is however a DMA Controller to transfer data from CD/DRAM to VRAM/SRAM. 
</p>

<div class='heading'>Video System</div><hr/><p>
	Even though the video system supports 24-bit colors, very few games used it (except for Heart Of Darkness backgrounds<a name="back_4" style="text-decoration: none;" href="index.html#footnote_4"><sup>[4]</sup></a>). In practice, it is fair to say most games used 16-bit colors with 1-bit mask.
    <br/><br/>
  <br/><br/>
 

 <table style="margin-bottom: 2ch;margin-top: 2ch; width: 100%;">
  <tr>
    <td style="width: 50%;">
 <picture>
        <source srcset="clear_5bit.webp" type="image/webp">
        <img src="clear_5bit.png" style="/*width: 800px; height:941px; */width : 90%;" align="left">
    </picture>
</td>
    <td style="width: 50%;">
       <picture>
        <source srcset="dark_5bit.webp" type="image/webp">
        <img src="dark_5bit.png" style="width : 90%;" align="right">
    </picture>
  </td>
</tr>
</table>
<span style="text-align: center; display: block; margin-bottom: 2ch;"><i><small>PSX 15-bit per pixel color space</small></i></span> 
    <br/><br/>
    What is really cool about the video system is the organization of the VRAM which is entirely up to the developer. The 1 MiB of VRAM is treated as a 1024 x 512 x 16-bit array which can be carved freely. Using double buffering or triple buffering is trivial since an area only needs to be reserved, drawn and pointed out to the output system. Textures also reside in VRAM next to the framebuffers. To write to a framebuffer, GPU commands are issued in order to draw textured triangles/quads.
    <br/><br/>
    Textures can have various formats. There are two direct 16-bit and 24-bit colors sources but also palette, called Color Look Up Table (CLUT), based sources. 8-bit CLUT and 4-bit CLUTs are supported.
    <br/><br/>
    In terms of resolutions, the console was constrained by the NTSC and PAL Television standards. For US and Japanese markets, a developer could pick an horizontal resolution of 256, 320, 384, 512, or 640. Vertical resolution was either 240 pixels (by skipping every other scanline) or 480 pixels interleaved. Both vertical modes ran at 60Hz. The only difference between NTSC and PAL is the increased vertical resolution (256/512 instead of 240/480) and the lowered refresh rate (50Hz).<br/>
    <pre>
Mode      NTSC(60Hz)       PAL (50Hz)        Remark
==========================================================

0         256 x 240        256 x 256         Non-Interlaced
1         320 x 240        320 x 256         Non-Interlaced
2         512 x 240        512 x 256         Non-Interlaced
3         640 x 240        640 x 256         Non-Interlaced
4         256 x 480        256 x 512         Interlaced
5         320 x 480        320 x 512         Interlaced
6         512 x 480        512 x 512         Interlaced
7         640 x 480        640 x 512         Interlaced
8         384 x 240        384 x 256         Non-Interlaced
9         384 x 480        384 x 512         Interlaced
    </pre>
    <p>
    Notice the 384 pixels wide modes (8 and 9) which seem to have been a late addition based on their id. 
</p>






<div class='heading'>DOOM on PSX</div><hr/><p style="margin-bottom: 1ch;">
	DOOM was ported to the PSX by Williams Entertainment with some assistance from id Software. It took a little bit less than a year
for a team of five<a name="back_5" style="text-decoration: none;" href="index.html#footnote_5"><sup>[5]</sup></a><a name="back_6" style="text-decoration: none;" href="index.html#footnote_6"><sup>[6]</sup></a> to port the engine, change the assets, and make everything work with "only" 3.5 MiB of RAM.<br/>
<br/>
    <blockquote>
The graphics were reduced: the textures chopped down in size, the sprites,
monsters, and weapons reduced in size. [...] Sometimes animations had
frames cut.
    	<br/>
    	<br/>
    	<div>- Harry Teasley</div>
    </blockquote>
<p style="margin-bottom: 1ch;">

 The result shipped on November 16, 1995. It is universally considered the best console port with
some aspects even outmatching the PC version thanks to colored vertex and CD quality musics.
    <br/><br/>
    <blockquote>
    	This is the best DOOM yet!
    	<br/>
    	<br/>
    	<div>- John Romero</div>
    </blockquote>
<p>





<div class='heading'>Study plan</div><hr/><p>

	<img src="doom_arch.svg" style="width: 27%; box-sizing: border-box; float:right; margin-top: 0ch; margin-left: 2ch;"> 
	Because of the way it was developed, DOOM is designed around a core using six sub-systems for I/O. I spent most of the time studying what I expected to be the three most interesting parts, namely the CD-ROM based file-system, the SPU based audio, and the GPU based video since they are peculiar to the PSX architecture.
    <br/><br/>

	The original source code of of DOOM on PSX has never been released but it turned out to not be a problem at all. There is plenty of information out there.

    <br/><br/>
	The first source is the amazing PSY-Q SDK which was the "official" tool used by PSX developers at the time. There is a lot of documentation in the many PDFs provided. The abundance only confirmed all the good things I had heard over the years about the developer-friendliness of the PSX. The library (e.g: libcd, libds) developed by SCE<a name="back_7" style="text-decoration: none;" href="index.html#footnote_7"><sup>[7]</sup></a> are also well detailed. It was refreshing to find clear explanations when compared to the next to nothing provided on other *cough* SNES *cough* consoles.

    <br/><br/>
    Another source of information was the many external tools available nowadays. ISOBuster allowed to open the CD content. PSound was able to scan LCD archives. The awesome no$PSX emulator's ability to trace GPU and SPU commands were pure gold.
    <br/><br/>
    Finally and perhaps most impressively, DOOM on PSX has received a lot of love from the fan community. It has been fully reverse engineered. PSXDOOM-RE particularly stands out since it is a C codebase which can be compiled with PSY-Q SDK into a fully playable PSX game. The code hosted is highly reliable since the methodology used to produce it involved taking machine code and rewrite each functions in C.<br/>
</p>

<div class='heading'>The marvelous world of compact discs</div><hr/><p>
	Before studying the file-system implementation, I make a small detour to understand the marvelous world of Compact Discs.
    <br/><br/>
	Several volumes of specifications covering the topic, together called the "Rainbow Books", were released over a period of 20 years from 1980 to 2000. The first in the series, the "Red Book", specs the original audio Compact Disk (CD). The "Yellow Book" is an extension of the red book, introducing CD-ROM data and ISO-9600. The "Orange Book" adds CD-DA specs, CD-R (Recordable), and CR-WR (Rewritable). The "White Book" is dedicated to Video-CD (VCD). The "Green Book" is about CD-Interactive (CD-I). The "Blue Book" is about Enhanced-CD (ECD) for multimedia support. The "Scarlet Book" covers Super Audio (SACD) introducing high-resolution audio. The "Purple Book" is about Double Density CD (DDCD) pushing capacity from 650MiB to 1.3GiB. Finally the "Cyan Book" covers the 9660 filesystem specs extensively<a name="back_8" style="text-decoration: none;" href="index.html#footnote_8"><sup>[8]</sup></a>.<br/>

	<img src="rainbow_books.svg" style="width: 100%; margin-bottom: 2ch; margin-top: 2ch; margin-left: 0p; margin-right: 0;"/> 
	<span style="text-align: center; display: block; margin-bottom: 2ch;"><i><small>The "Rainbow Books" cover everything to be known about CDs.</small></i></span> 
	<br/>
	The absolute minimum to understand is that PSX CDs are usually made of sectors containing 2048 bytes of payload each. Sectors are grouped in tracks (which can be data or audio). Tracks are grouped into sessions. Data track information can be organized using ISO-9660 standard filesystem although a game can also ship with hard-coded sectors addresses.
	<br/>


<div class='heading'>Inside DOOM CD</div><hr/><p>
	<picture>
  <source srcset="doom_psx_layout.webp" type="image/webp"> 
	<img src="doom_psx_layout.png" style="width: 20%; box-sizing: border-box; float:right; margin-top: 0ch; margin-left: 2ch;"> 
</picture>
	Peeking inside the CD-ROM with ISOBuster revealed that DOOM is made of one session containing eight tracks<a name="back_9" style="text-decoration: none;" href="index.html#footnote_9"><sup>[9]</sup></a>. Seven of them are CD quality audio songs for intermission and end-scene. The ending track (#7) even uses digitized demon voices. Track #6 stands out particularly since it seems to have been taken straight out of a rave party. It turns out it is the music played in "Club DOOM" super-secret map #59 (a secret map only accessible from a secret map)<a name="back_10" style="text-decoration: none;" href="index.html#footnote_10"><sup>[10]</sup></a>. I will let you judge the craziness by yourself.
	<br/>
	<div style="width:auto; box-sizing: border-box; overflow: hidden; margin-bottom: 0ch;">
	<audio controls style="width:100%;" >
      <source src="Track06.mp3" type="audio/mpeg">
      Your browser does not support the audio element.
    </audio>
      <span style="text-align: center; display: block; margin-bottom: 0ch; margin-top: 1ch; text-transform: none;"><i><small>WARNING: Double check audio volume before pressing "Play".</small></i></span> 
  <br/>
    </div>
    <p>
    The remaining track (#1) is an ISO-9660 containing the game engine and most assets. Having studied many ports of DOOM, I naively expected an engine DOOM.EXE, an asset file PSXDOOM.WAD, and maybe a manifest. I was very wrong. There are 287 files in there<a name="back_11" style="text-decoration: none;" href="index.html#footnote_11"><sup>[11]</sup></a><a name="back_12" style="text-decoration: none;" href="index.html#footnote_12"><sup>[12]</sup></a> among them 60 .WADs, 120 .IMGs, and countless .LCDs.
	<br/>
	<br/>
	The data is organized on a per-level basis (fives files per map).<br/>
	<pre>
Filename                 Description
=======================================================

MAPDIR0/MAP01.WAD        Standard Geometry (BSP/Reject/...)
MAPDIR0/MAPTEX01.IMG     Flat/walls textures
MAPDIR0/MAPSPR01.IMG     All sprites emitted by THINGS
MUSIC/MUSLEV1.LCD        Music to be played
SNDMAPS1/MAP01.LCD       All sounds emitted by THINGS
</pre>
<p>
	A beginning of answer to this new way to do things came from Crash Bandicoot developer Andy Gavin interviewed by Ars Technica.
<blockquote style="width:auto; box-sizing: border-box; overflow: hidden; margin-bottom: 2ch;">
	The CD takes about 1/3 of a second to move its head to any specific spot on the CD.
    <br/>
  <br/>
<div>- Andy Gavin</div>	
</blockquote>
<p>
	With a seek time nearing 300ms (confirmed in PSY-Q documentation<a name="back_13" style="text-decoration: none;" href="index.html#footnote_13"><sup>[13]</sup></a>), there was no way for the Williams Entertainment developers to keep the clean architecture of DOOM which stored every asset in one file (e.g: DOOM.WAD) and loaded them on demand. That would have killed the framerate.
	<br/>
	<br/>
	They solved the issue by throwing some of the seemingly infinite amount of bytes of the CD at the problem. Every assets needed in a level are stored in five files covering map geometry, textures, sprites, SFX, and musics. It is wasteful but removing CD usage at run-time worked.
	<br/>
	<br/>
	<b><u>Trivia:</u></b> In the list of files on the data track, there is a file named PSXDOOM.WAD (4,806,088 bytes) but it is only used to load the palettes and a few menu images. It was probably used more extensively during development.
	<br/>
	<br/>
	In the case of the first map, the total volume of data to load is reduced from 4MiB to 900 KiB <br/>
    <pre>
Filename               Size (bytes)  
===================================  	
MAPDIR0/MAP01.WAD            28,196
MAPDIR0/MAPTEX01.IMG         90,744
MAPDIR0/MAPSPR01.IMG        590,344
MUSIC/MUSLEV1.LCD            61,232
SNDMAPS1/MAP01.LCD          143,632
===================================
Total:                      914,148                  
    </pre>	
<p>
	Looking at 914 KiB of assets make it seems like there was a lot of unused DRAM. But you need to keep in mind that the 428 KiB executable also had to fit in there along with the stack, runtime variable. Runtime only had about 1 MiB of DRAM actually available.
	<br/>
	<br/>

	<b><u>Trivia:</u></b> Digging into PSXDOOM-RE source code we find a P_LoadBlocks function which will attempt to read from the CD up to 4 times <a name="back_14" style="text-decoration: none;" href="index.html#footnote_14"><sup>[14]</sup></a> before giving up. One of the joy of dealing with scratch-able medias.
<br/>
	<br/>
	I did not expect the CD-ROM seek time to have such a major impact on the design of a game. Some titles such as Crash Bandicoot built from the ground up with a paging system managed to stream the content from the CD at runtime. In the case of DOOM the engine could not do it. The CD is not used during game except for the One special songs (yes, Club DOOM). 

  <br/> <br/>
  People at id Software were never fan of the trade-off capacity/speed CD-ROMs brought to the table.
<blockquote>
	The major argument is somewhat philosophical. I don’t like what people expect out of CD games. Does anyone think that the cheeseball dialog in crash and burn is a GOOD addition? It turns my stomach. People expect CD games to have tons of digitized speech and video, and the 3DO is going to be strongly associated with it. The joke here is that if we ever do a CD version of DOOM, you are  going to get the game and “The Making of DOOM” a one hour feature film. Companies spend hundreds of thousands of dollars putting all this media into their games, and it often actually detracts from it. We don’t want to be part of this crowd.
	<br/>
	<br/>
I would rather cut down to the essentials and fit on a cartridge than uselessly bulk up on a CD. I have a minimalist sense of aesthetics in game design.
	<br/>
	<br/>
	<div>- John Carmack (ATARI EXPLORER ONLINE, 22 January 1994)</div>
</blockquote>
<p>
	<b><u>Trivia:</u></b> DOOM events are triggered via trip-wires. When crossed, a line with a special property will call a special function. The "legacy" version of the engine did not have a property allowing to play a song. A special linedef action (#142) was created to trigger playback of Club DOOM<a name="back_15" style="text-decoration: none;" href="index.html#footnote_15"><sup>[15]</sup></a>. It is astonishing how much customization went into creating this level. They must have really really liked to rave.
</p>















<div class='heading'>The case of the missing Archvile</div><hr/><p>
  When I was doing research for the Game Engine Black Book, I never fully understood this quote from designer Harry Teasley.<br/>

<blockquote style="width:auto; box-sizing: border-box; overflow: hidden; margin-bottom: 2ch;">
  The archvile had twice as many frames of animation as any other monster,
and we just couldn’t do him justice on the PSX. Couldn’t lose his attack, and
couldn’t lose his resurrecting power. He was just too big to include.
  <br/>
  <br/>
  <div>- Harry Teasley (Designer) for doomworld.com </div>
</blockquote>
<p>
Indeed peeking inside the PC archive DOOM2.WAD, we can see the arch-vile features 145 frames. In comparaison, the imp has 52 frames (thanks greatly to mirroring).<br/>
<picture>
  <source srcset="arch-vile.webp" type="image/webp"> 
  <img class="pixel" src="arch-vile.png" style="width:100%; margin-bottom: 1ch; margin-top:2ch; border: 1px black solid;float:right;">
</picture>
<span style="text-align: center; display: block; margin-bottom: 2ch;"><i><small>The arch-vile enemy required 145 frames on PC whick the PSX could not accomodate.</small></i></span>
<p>
  Even though it was clear the 650 MiB capacity of the CD was not the problem, it was unclear whether the DRAM or the VRAM were the limiting factor.
  <br/>
  <br/>
   With the insight of CD-ROM constraints, it seems the issue was not to store the sprite on the CD or even to feed them from DRAM to VRAM. The problem was to be able to keep everything in DRAM.<br/> 
  <br/>
</p>
<p>
    <u>EDIT: Nov 27th, 2022:</u> After the publication of this article, Harry Teasley emailed to confirm it was a DRAM size matter.
</p>
<blockquote style="width:auto; box-sizing: border-box; overflow: hidden; margin-bottom: 2ch;">
We had limited space for monsters, only being able to fit a few in each level: several maps had one or more variety of monster removed because we couldn't make them all fit in memory.
  <br/>  <br/>
The Archvile was as expensive as 2-3 monsters, and one of his abilities was "resurrecting other monsters", an ability that got considerably less cool if there were only like one other type of monster in the map.
  <br/>  <br/>
The maps that included the Archvile had a large variety of monsters, and would have played *very* differently. We made what we thought would be the least painful cut.
  <br/>
  <br/>
  <div>- Harry Teasley (Designer) email</div>
</blockquote>

<p>
  <b><u>Trivia:</u></b> In the source code of PSXDOOM-RE the ArchVile is completely removed. Even its #DEFINE is commented out<a name="back_16" style="text-decoration: none;" href="index.html#footnote_16"><sup>[16]</sup></a>.<br/>

<pre style="color:#000000;background:#ffffff;"><span style="color:#004a43; ">#</span><span style="color:#004a43; ">define</span><span style="color:#004a43; "> CC_ZOMBIE  </span><span style="color:#800000; ">"</span><span style="color:#0000e6; ">Zombieman</span><span style="color:#800000; ">"</span>
<span style="color:#004a43; ">#</span><span style="color:#004a43; ">define</span><span style="color:#004a43; "> CC_SHOTGUN  </span><span style="color:#800000; ">"</span><span style="color:#0000e6; ">Shotgun Guy</span><span style="color:#800000; ">"</span>
<span style="color:#004a43; ">#</span><span style="color:#004a43; ">define</span><span style="color:#004a43; "> CC_HEAVY  </span><span style="color:#800000; ">"</span><span style="color:#0000e6; ">Heavy Weapon Dude</span><span style="color:#800000; ">"</span>
<span style="color:#808030; ">.</span><span style="color:#808030; ">.</span><span style="color:#808030; ">.</span>
<span style="color:#004a43; ">#</span><span style="color:#004a43; ">define</span><span style="color:#004a43; "> CC_HELL   </span><span style="color:#800000; ">"</span><span style="color:#0000e6; ">Hell Knight</span><span style="color:#800000; ">"</span>
<span style="color:#696969; ">//#define CC_ARCH "Arch-Vile"</span>
<span style="color:#004a43; ">#</span><span style="color:#004a43; ">define</span><span style="color:#004a43; "> CC_SPIDER </span><span style="color:#800000; ">"</span><span style="color:#0000e6; ">The Spider Mastermind</span><span style="color:#800000; ">"</span>
<span style="color:#004a43; ">#</span><span style="color:#004a43; ">define</span><span style="color:#004a43; "> CC_CYBER  </span><span style="color:#800000; ">"</span><span style="color:#0000e6; ">The Cyberdemon</span><span style="color:#800000; ">"</span>
<span style="color:#004a43; ">#</span><span style="color:#004a43; ">define</span><span style="color:#004a43; "> CC_HERO   </span><span style="color:#800000; ">"</span><span style="color:#0000e6; ">Our Hero</span><span style="color:#800000; ">"</span>
</pre>

</p>













<div class='heading'>Programming the SPU</div><hr/><p>
	The SPU chip understands only one format which is ADPCM. It can mix up to 24 channels (including CD audio track) and has powerful audio manipulation capabilities.

	<br/>
	<br/>
	To harness this beast, DOOM PSX uses libWESS (Williams Entertainment Sound System) which was written by audio engineer Scott Patterson. The library is quite powerful since it is able to replicate a MiDI system where an "heavy" bank of notes (called sound font) is piloted by a "lighweight" music partition. It is also able to manipulate audio attributes such as volume, pitch, note velocity, and ADSR functions (Attack, Decay, Sustain, and Release) in real-time. All musics during gameplay are generated via libWESS. The one exception, you will have guessed of course, is "Club DOOM" which is played from CD track #6.
	<br/>
	<br/>
	 WESS relies on two proprietary file formats. There are .WMD files which contains the partition for music and SFX. There are .LCD which are PSX VAG (without an header) and containing ADPCM samples. When DOOM starts, libWESS loads all SFX (89) and music (19) partitions contained in a small, 55 KiB, file named DOOMSND.WMD. It also loads the "always-used" ADPCM samples used for the doomguy, doors, etc to SRAM.<br/>
	<pre>
MUSIC/DOOMSFX.LCD -> SRAM
MUSIC/DOOMSND.WMD -> DRAM
</pre>
<p>
	When a map is loaded, libWESS opens MUSIC/MUSLEV%.LCD which contains the ADPCM samples used by this map music and SNDMAPS%/MAP%%.LCD which contains the ADPCM samples needed for the enemies in this level. All the ADPCM samples are uploaded directely to SRAM and have no impact on DRAM consumption.
</p>











<div class='heading'>DOOM on PSX: GPU</div><hr/><p>
	For the video generation part, Williams Entertainment had two problems to solve. There was the small amount of VRAM (we will come back to this later). And there was the lack of perspective-correct texture mapping problem.<br/> 
<blockquote style="width:auto; box-sizing: border-box; overflow: hidden; margin-bottom: 1ch;">
	I worked with Aaron Seeler on the Nintendo 64 (which was a fairly different
game) and Playstation versions. Those were the first versions that weren’t
written "to the metal", since both Sony and Nintendo were forcing (at least
third party) developers to write to API instead of just handing them hardware
register documentation. The SGI culture in particular cramped developers at
the start, but Nintendo eventually walked it back a bit.
    <br/><br/>
Funny story on Playstation development: Aaron and I started out with a
different engine architecture that rendered the world with triangles, since they
were fully hardware accelerated. That worked great on the N64, which had
subpixel accurate, perspective correct rendering (that SGI influence), but
Playstation had integer coordinate, affine texture mapping, and the big wall
and floor triangles looked HORRIBLE.
<br/>
<br/>

	<div>- John Carmack (Game Engine Black Book: DOOM)</div>
</blockquote>
<p style="margin-bottom: 0ch;">
	To give get an idea of how "horrible" it looked, here are three walls rendered with affine and perspective-correct texturing.<br/>
  <img class="pixel" src="game_perspective_texturing.png" id="tex0" width="100%" style="margin-top: 2ch; margin-bottom: 1ch; border: 1px black solid;">
    <script type="text/javascript">
  function setScreenshot(e, id) {
    document.getElementById('tex' + id).src='game_' + e.value + '.png';
  }
</script>
<form >
    <div style="width: 100%; display: inline-block; margin-top: 0px;text-transform: none;">
      <center> Three walls with texturing :  
  <input type="radio" name="tex" id=perspective_texturing value="perspective_texturing" onclick="setScreenshot(this, '0');" checked="checked" ></input><label for="perspective_texturing">Perspective Correct</label>
  <input type="radio" name="tex" id=affine_texturing value="affine_texturing" onclick="setScreenshot(this, '0');"></input><label for="affine_texturing">Affine (PSX)</label>.
  </center>
</div>
</form>
<p style="margin-bottom: 2ch;">Notice how there is no problem with a front facing wall but distortion because more and more of a problem as perspective increase.
	<br/><br/>
    This perceptive issue is the same one encountered by Rage Software developers while porting DOOM to SEGA Saturn.<br/>

    <blockquote>
    	When I started the project, I had to do a demo for id Software to approve.
I started by extracting all the levels and audio and textures from the WAD
files and made my own Saturn version of this, then got an early version of
the renderer working using the 3D hardware. This got sent off and a couple
days later I got a call from John Carmack, who stipulated that under no
circumstances could I use the 3D hardware to draw the screen. I had to use
the processor like the PC. Thankfully I enjoy challenges, so it turned out to be
a really enjoyable project, using both SH2s to render the display like the PC
did it, using the 68000 to orchestrate them both.
<br/>
<br/>
However, it kneecapped the game and the speed-framerate suffered greatly.
<br/>
<br/>
    	<div>
- Jim Bagley (DOOM Saturn developer) for RetroGamer #134.
</div>
    </blockquote>

<p>
     Perhaps because they could afford more time, the PSX developers managed to solve the perspective-correct texture mapping problem by re-purposing the GPU polygon renderer into a line renderer.
</p>
    <blockquote style="width:auto; box-sizing: border-box; overflow: hidden;">
	I said "back everything up (no source
control back then!), we’re going to do something completely different".
We wound up using the hardware to render triangles that were one pixel wide
columns or rows, just like the PC asm code, and it worked well. The more
common Playstation approach turned out to be tessellating geometry in two
axis, but I was always pretty happy with how Doom felt less "wiggly" than most
other Playstation games of the time.
<br/>
<br/>
	<div>- John Carmack (Game Engine Black Book: DOOM)</div>
</blockquote>
<p style="margin-bottom: 2ch;">
	Thanks to project PSXDOOM-RE<a name="back_17" style="text-decoration: none;" href="index.html#footnote_17"><sup>[17]</sup></a> we can take a look at how this was done. The rendering pipeline was completely rewritten into two phases. It is detailed in a latter section but we can indeed see where the wall rendering function R_Render_Wall issues hard-code 1 pixel wide drawing commands.<br/>
	<br/>

<pre style="color:#000000;background:#ffffff;"><span style="color:#800000; font-weight:bold; ">void</span> R_Render_Wall<span style="color:#808030; ">(</span><span style="color:#808030; ">.</span><span style="color:#808030; ">.</span><span style="color:#808030; ">.</span><span style="color:#808030; ">)</span> <span style="color:#800080; ">{</span>
  <span style="color:#808030; ">.</span>
  <span style="color:#800000; font-weight:bold; ">int</span> x1 <span style="color:#808030; ">=</span> <span style="color:#808030; ">.</span><span style="color:#808030; ">.</span><span style="color:#808030; ">.</span> <span style="color:#800080; ">;</span> <span style="color:#696969; ">// Left end of wall.</span>
  <span style="color:#800000; font-weight:bold; ">int</span> x2 <span style="color:#808030; ">=</span> <span style="color:#808030; ">.</span><span style="color:#808030; ">.</span><span style="color:#808030; ">.</span> <span style="color:#800080; ">;</span> <span style="color:#696969; ">// Right end of wall.</span>
  <span style="color:#808030; ">.</span>
  <span style="color:#800000; font-weight:bold; ">while</span><span style="color:#808030; ">(</span>x1 <span style="color:#808030; ">&lt;</span> x2<span style="color:#808030; ">)</span> <span style="color:#800080; ">{</span>
    <span style="color:#808030; ">.</span>
    setRGB0<span style="color:#808030; ">(</span>wallpoly<span style="color:#808030; ">)</span><span style="color:#800080; ">;</span>

    setXY3<span style="color:#808030; ">(</span>wallpoly<span style="color:#808030; ">,</span>
      x1    <span style="color:#808030; ">,</span> ypos1 <span style="color:#808030; ">-</span> <span style="color:#008c00; ">1</span><span style="color:#808030; ">,</span>
      x1 <span style="color:#808030; ">+</span> <span style="color:#008c00; ">1</span><span style="color:#808030; ">,</span> ypos2 <span style="color:#808030; ">+</span> <span style="color:#008c00; ">1</span><span style="color:#808030; ">,</span>
      x1    <span style="color:#808030; ">,</span> ypos2 <span style="color:#808030; ">+</span> <span style="color:#008c00; ">1</span><span style="color:#808030; ">)</span><span style="color:#800080; ">;</span>		

    setUV3<span style="color:#808030; ">(</span>wallpoly<span style="color:#808030; ">,</span>
         upos<span style="color:#808030; ">,</span> v0<span style="color:#808030; ">,</span>
         upos<span style="color:#808030; ">,</span> v1<span style="color:#808030; ">,</span>
         upos<span style="color:#808030; ">,</span> v1<span style="color:#808030; ">)</span><span style="color:#800080; ">;</span>  
    <span style="color:#808030; ">.</span>
    x1 <span style="color:#808030; ">+</span><span style="color:#808030; ">=</span> <span style="color:#008c00; ">1</span><span style="color:#800080; ">;</span>
  <span style="color:#800080; ">}</span>
<span style="color:#800080; ">}</span>
</pre>

<span style="text-align: center; display: block; margin-bottom: 2ch;"><i><small>Wall are rendered with one pixel wide columns. Notice the OpenGL Immediate mode like API.</small></i></span>
<p><b><u>Trivia:</u></b> Sony hardware designer kept the i-cache of the MIPS CPU but disabled its d-cache to turn it into a high-speed 1KiB scratchpad. The wall/plane rendering routines use this scratchpad extensively.<br/><br/>

</p>






<div class='heading'>GPU VRAM Management</div><hr/><p style="margin-bottom: 1ch;">
	To study how VRAM is managed, I went the fun road by leveraging no$PSX emulator real-time VRAM viewer. The whole 1024 x 512 x 16-bit pixels is displayed (albeit distorded). The viewer also features a full list of all GPU commands issued by the CPU on a per-frame basis.<br/>
	<br/>
	<picture>
  <source srcset="intro.webp" type="image/webp"> 
  <img src="intro.png" width="100%" style="margin-top: 2ch; margin-bottom: 1ch;">
</picture>
<span style="text-align: center; display: block; margin-bottom: 2ch;"><i><small>No$PSX, a god-sent emulator allowing to look under the hood of the GPU.</small></i></span>
<br/>
 Taking a close look at the (properly sized) VRAM of the first frame allows to infer a lot.<br/>

	<picture>
  <source srcset="intro_vram.webp" type="image/webp"> 
  <img src="intro_vram.png" width="100%" style="margin-top: 2ch; margin-bottom: 1ch;">
</picture>
<span style="text-align: center; display: block; margin-bottom: 2ch;"><i><small> First frame of the game viewed with No$PSX.</small></i></span>
<p>
	The most obvious are the two 256 x 240 x 16-bit area in the upper left which are the framebuffers (therefore the game is double buffered). Note that 256x240 is the lowest resolution achievable by the PSX. 
	<br/>
	<br/>
	Below the framebuffers are a colorful set of pixels which are the CLUT palettes. Notice how there are shades of red which indicate the damage screen fade uses pre-calculated palettes.
	<br/>
	<br/>
	In the upper right, we see the textures which are weirdly squeezed horizontally and with "wrong" colors. This is because the textures use 8-bit indexes into the aforementioned CLUT.
	<br/>
</p>

<div class='heading'>DOOM PS1 Fire Again!</div><hr/><p>
	Back in 2018, I set some time aside to study how the fire effect was done<a name="back_18" style="text-decoration: none;" href="index.html#footnote_18"><sup>[18]</sup></a>. It was pretty cool to revisit it by looking at the GPU commands. Notice how each commands target area is outlined in red by no$PSX.<br/>
	<br/>

	Step 1: The fire is updated in RAM and uploaded to VRAM (CpuToVram command).<br/>
	<picture>
  <source srcset="fire_upload.webp" type="image/webp"> 
  <img src="fire_upload.png" width="100%" style="margin-top: 2ch; margin-bottom: 2ch;">
</picture>

	
	Step 2: The fire texture is drawn four times across the screen (QuadTex command). The fire texture is 32 texels wide but the GPU is leveraged to draw it 64 pixels wide. No bilinear-filtering available here, this is all nearest sampling.<br/>
	<picture>
  <source srcset="fire_draw.webp" type="image/webp"> 
  <img src="fire_draw.png" width="100%" style="margin-top: 2ch; margin-bottom: 2ch;">
</picture>

	Step 3: The "Final DOOM" plate is drawn on top of everything (QuadTex command).<br/>
	<picture>
  <source srcset="fire_plate_draw.webp" type="image/webp"> 
  <img src="fire_plate_draw.png" width="100%" style="margin-top: 2ch; margin-bottom: 2ch;">
</picture>
</p>




<div class='heading'>A Full Frame, command by command</div><hr/><p>
	Taking a look at all the commands issued in a frame showed that the engine is completely different from the PC version. In the latter, the world was traversed near to far. All walls were rendered first. The vertical gap between then (visplane) was filled on a second pass (which included the sky). A third and last pass rendered the sprites in far to near order. All this was done with zero pixel overwrite.
	<br/>
	<br/>
	On PSX, rendering is done in a slightly more bruteforce style. Everything is rendered in one pass which goes far to near. The visplane system used to fill void between walls is gone. Both plane and walls are rendered on a per-subsector basis thanks to a new concept called "leaves". This "true 3D" approach is made possible by extensive usage of the GPE matrix projection capabilities. Sprites are also rendered at the same time as wall/plane without any occlusion test/clipping which result in a bit of overdraw.

<pre style="color:#000000;background:#ffffff;"><span style="color:#800000; font-weight:bold; ">void</span> R_RenderPlayerView<span style="color:#808030; ">(</span><span style="color:#800000; font-weight:bold; ">void</span><span style="color:#808030; ">)</span> <span style="color:#800080; ">{</span>
  R_BSP<span style="color:#808030; ">(</span><span style="color:#808030; ">)</span><span style="color:#800080; ">;</span>         <span style="color:#696969; ">// Phase 1</span>
  R_RenderSKY<span style="color:#808030; ">(</span><span style="color:#808030; ">)</span><span style="color:#800080; ">;</span>   <span style="color:#696969; ">// Phase 2</span>
  <span style="color:#800000; font-weight:bold; ">for</span> <span style="color:#808030; ">(</span>all subsectors from phase <span style="color:#008c00; ">1</span><span style="color:#808030; ">)</span> <span style="color:#800080; ">{</span>
    R_RenderAll<span style="color:#808030; ">(</span>subsector<span style="color:#808030; ">)</span>
  <span style="color:#800080; ">}</span>
  R_Render_Hud_Weapons<span style="color:#808030; ">(</span><span style="color:#808030; ">)</span><span style="color:#800080; ">;</span>
<span style="color:#800080; ">}</span>
</pre>
<p>
    Let's take a look at each step in details, starting with the sky which is rendered first with a CopyRectRaw. no$PSX shows the VRAM as the end of a frame but allows to step back in the command history. The sky pixels can still be seen only because no$PSX has trouble dealing with the one pixel wide hack (other emulators such as ePSXe don't perform much better either<a name="back_19" style="text-decoration: none;" href="index.html#footnote_19"><sup>[19]</sup></a>) but all of it would have been overwritten. Notice below the sky textures, how the door key markers are atlased together.<br/>


	<picture>
  <source srcset="1.webp" type="image/webp"> 
  <img src="1.png" width="100%" style="margin-top: 2ch; margin-bottom: 2ch;">
</picture>

Next the BSP is traversed in far to near order. For each subsectors, all walls/planes/sprites are rendered. If you are familiar with DOOM BSP you probably remember that doombsp compiler used to only store solid segments in sub-sectors. To allow planes rendering, a new concept of "leaf" was introduced to also store BPS split segment (which are invisible). These segments are projected in screenspace to generate plane boundaries. This is much "cleaned" since it eliminate screen-space hack and bugs such as "Slime trail".<br/>
	<picture>
  <source srcset="2.webp" type="image/webp"> 
  <img src="2.png" width="100%" style="margin-top: 2ch; margin-bottom: 2ch;">
</picture>

In the next VRAM capture, planes from the same subsector as the wall we just saw are rendered as 1 pixel tall triangles. Also pay attention to the wall/plane textures which all have the same dimension. This property makes texture VRAM allocation easy and prevent fragmentation.<br/>
<br/>
	<picture>
  <source srcset="3.webp" type="image/webp"> 
  <img src="3.png" width="100%" style="margin-top: 2ch; margin-bottom: 2ch;">
</picture>

We are still in the same sub-sector. Now sprites are rendered as Quads. This include enemies, projectiles, partially transparent walls.<br/>
	<picture>
  <source srcset="4.webp" type="image/webp"> 
  <img src="4.png" width="100%" style="margin-top: 2ch; margin-bottom: 2ch;">
</picture>

Plasma bullets just for fun.<br/>
	<picture>
  <source srcset="5.webp" type="image/webp"> 
  <img src="5.png" width="100%" style="margin-top: 2ch; margin-bottom: 2ch;">
</picture>

We are now reaching the end of the draw commands. The weapon is rendered with a rectangle blend.<br/>
	<picture>
  <source srcset="6.webp" type="image/webp"> 
  <img src="6.png" width="100%" style="margin-top: 2ch; margin-bottom: 2ch;">
</picture>

Final step. Rendering the HUD.<br/>
	<picture>
  <source srcset="7.webp" type="image/webp"> 
  <img src="7.png" width="100%" style="margin-top: 2ch; margin-bottom: 2ch;">
</picture>
</p>






<div class='heading'>VRAM overflow!</div><hr/><p>
	<picture>
      <source srcset="overflow.webp" type="image/webp"> 
	  <img src="overflow.png" style="margin-left: 2ch; float:right; width: 30%;"/>
	</picture>
   Working with the GPU was an exercise in VRAM space allocation. For this game it is a trivial task when it comes to framebuffers, CLUTs, static (HUD) contents, and even wall/flat since they are all the same dimension. Things get more complicated when it comes to sprites.
	<br/>
	<br/>
   Because they have different dimension, sprites lead to fragmentation. Moreover if textures can cover large area and are repeated, sprites are often unique and many of them can be needed in unpredictable capacity. The worse case scenario is when a frame requires a certain number of sprites but they cannot fit in VRAM. This is called a "Texture Cache Overflow" and there is no recovery. When it happens, the game crashes and displays a cryptic error message<a name="back_20" style="text-decoration: none;" href="index.html#footnote_20"><sup>[20]</sup></a> reminding some of us of the dreaded "No more visplanes".
	<br/>
	<br/>


<picture>
  <source srcset="mashed_potatoes.webp" type="image/webp"> 
  <img src="mashed_potatoes.png" width="100%" style="margin-top: 2ch; margin-bottom: 1ch; border: 1px black solid;">
</picture>
<span style="text-align: center; display: block; margin-bottom: 2ch;"><i><small>The more sprites visible at the same time, the higher the VRAM watermark.</small></i></span>
</p>






<div class='heading'>PAL vs NTSC</div><hr/><p>
	Before closing the video chapter, I took a look at the conversion from NTSC to PAL. Unfortunately, like many others titles, DOOM PSX did not account for the increased vertical resolution. Playing DOOM on PS1 in Europe resulted in a vertically compressed image with significant black borders.<br/> 
	<br/>
	With the insight of how VRAM works, I have a hard time to blame the developers. If you look closely at the NTSC VRAM layout, you will notice that increasing the vertical resolution of the framebuffer completely messes up the allocation scheme. There would be no way to store textures underneath. Or the CLUT would have to be moved somewhere else. This looks like a significant effort for little payoff
	and even as a player who suffered from black borders I would agree it was not worth the trouble.
</p>






<div class='heading'>Acknowledgments</div><hr/><p>
  Thanks to Erick Vásquez (PSXDOOM-RE author), Samuel Villarreal (PSXDOOM-RE contributor), and Dan Leslie (Professional PlayStation 1 developer) for generously providing their knowledge.
</p>
<style type='text/css'>td.ref {  padding-bottom: 0ch; width:0;}</style><div class='heading'>References</div><hr/><p id='paperbox' style='text-align:left;'><table><tbody style='vertical-align: top;'><tr><td class='ref' style='width:1ch;'><a name="footnote_1"></a><a href="index.html#back_1">^</a></td><td  class='ref' style='width:4ch;'> [ 1]</td><td style='width:100%;text-align:left;' class='ref'><a href="../another_world_polygons/index.html">The Polygons Of Another World</a></td></tr><tr><td class='ref' style='width:1ch;'><a name="footnote_2"></a><a href="index.html#back_2">^</a></td><td  class='ref' style='width:4ch;'> [ 2]</td><td style='width:100%;text-align:left;' class='ref'><a href="../gebb/index.html">Game Engine Black Book: DOOM</a></td></tr><tr><td class='ref' style='width:1ch;'><a name="footnote_3"></a><a href="index.html#back_3">^</a></td><td  class='ref' style='width:4ch;'> [ 3]</td><td style='width:100%;text-align:left;' class='ref'><a href="psx.pdf">Everything You Have Always Wanted to Know about the Playstation</a></td></tr><tr><td class='ref' style='width:1ch;'><a name="footnote_4"></a><a href="index.html#back_4">^</a></td><td  class='ref' style='width:4ch;'> [ 4]</td><td style='width:100%;text-align:left;' class='ref'><a href="https://twitter.com/gmontoir/status/1243361728169046016">@gmontoir - 'Heart of Darkness uses MDEC frames as background bitmaps.'
</a></td></tr><tr><td class='ref' style='width:1ch;'><a name="footnote_5"></a><a href="index.html#back_5">^</a></td><td  class='ref' style='width:4ch;'> [ 5]</td><td style='width:100%;text-align:left;' class='ref'><a href="https://5years.doomworld.com/interviews/harryteasley/">Five years of DOOM, part 1</a></td></tr><tr><td class='ref' style='width:1ch;'><a name="footnote_6"></a><a href="index.html#back_6">^</a></td><td  class='ref' style='width:4ch;'> [ 6]</td><td style='width:100%;text-align:left;' class='ref'><a href="https://5years.doomworld.com/interviews/harryteasley/page2.shtml">Five years of DOOM, part 2</a></td></tr><tr><td class='ref' style='width:1ch;'><a name="footnote_7"></a><a href="index.html#back_7">^</a></td><td  class='ref' style='width:4ch;'> [ 7]</td><td style='width:100%;text-align:left;' class='ref'><a href="https://twitter.com/gtktktmbc/status/1243619751206760449">'The SDK libs were developed by SCE except of LibSN (SN Systems)' -Jonathan Ingram</a></td></tr><tr><td class='ref' style='width:1ch;'><a name="footnote_8"></a><a href="index.html#back_8">^</a></td><td  class='ref' style='width:4ch;'> [ 8]</td><td style='width:100%;text-align:left;' class='ref'><a href="https://archive.vn/20121209124333/http://library.thinkquest.org/C0112823/greatbooks_cd.htm">The Great Books</a></td></tr><tr><td class='ref' style='width:1ch;'><a name="footnote_9"></a><a href="index.html#back_9">^</a></td><td  class='ref' style='width:4ch;'> [ 9]</td><td style='width:100%;text-align:left;' class='ref'><a href="tracks.html">DOOM PSX tracks</a></td></tr><tr><td class='ref' style='width:1ch;'><a name="footnote_10"></a><a href="index.html#back_10">^</a></td><td  class='ref' style='width:4ch;'> [10]</td><td style='width:100%;text-align:left;' class='ref'><a href="https://doomwiki.org/wiki/MAP59:_Club_Doom_(PlayStation_Doom)">MAP59: Club Doom (PlayStation Doom)</a></td></tr><tr><td class='ref' style='width:1ch;'><a name="footnote_11"></a><a href="index.html#back_11">^</a></td><td  class='ref' style='width:4ch;'> [11]</td><td style='width:100%;text-align:left;' class='ref'><a href="tree.html">PSXDOOM/tree.txt</a></td></tr><tr><td class='ref' style='width:1ch;'><a name="footnote_12"></a><a href="index.html#back_12">^</a></td><td  class='ref' style='width:4ch;'> [12]</td><td style='width:100%;text-align:left;' class='ref'><a href="PSXDOOM.html">PSXDOOM files</a></td></tr><tr><td class='ref' style='width:1ch;'><a name="footnote_13"></a><a href="index.html#back_13">^</a></td><td  class='ref' style='width:4ch;'> [13]</td><td style='width:100%;text-align:left;' class='ref'><a href="cd4.pdf">PSY-Q SDK, CD Hardware</a></td></tr><tr><td class='ref' style='width:1ch;'><a name="footnote_14"></a><a href="index.html#back_14">^</a></td><td  class='ref' style='width:4ch;'> [14]</td><td style='width:100%;text-align:left;' class='ref'><a href="https://github.com/Erick194/PSXDOOM-RE/blob/fb4afd6d88e57b80ee4d50ead963832d7354c2d7/PSXDOOM/p_setup.c#L920">P_LoadBlocks</a></td></tr><tr><td class='ref' style='width:1ch;'><a name="footnote_15"></a><a href="index.html#back_15">^</a></td><td  class='ref' style='width:4ch;'> [15]</td><td style='width:100%;text-align:left;' class='ref'><a href="https://github.com/Erick194/PSXDOOM-RE/blob/909b4bd9b030ee4ea3b38c918551848f91532b0f/PSXDOOM/p_spec.c#L538">Linedef #142 plays Club Doom</a></td></tr><tr><td class='ref' style='width:1ch;'><a name="footnote_16"></a><a href="index.html#back_16">^</a></td><td  class='ref' style='width:4ch;'> [16]</td><td style='width:100%;text-align:left;' class='ref'><a href="https://github.com/Erick194/PSXDOOM-RE/blob/86262922f7a29dfdd23061f729b4c5bf6d197190/PSXDOOM/f_main.c#L55">//#define CC_ARCH</a></td></tr><tr><td class='ref' style='width:1ch;'><a name="footnote_17"></a><a href="index.html#back_17">^</a></td><td  class='ref' style='width:4ch;'> [17]</td><td style='width:100%;text-align:left;' class='ref'><a href="https://github.com/Erick194/PSXDOOM-RE">PSXDOOM-RE Source code</a></td></tr><tr><td class='ref' style='width:1ch;'><a name="footnote_18"></a><a href="index.html#back_18">^</a></td><td  class='ref' style='width:4ch;'> [18]</td><td style='width:100%;text-align:left;' class='ref'><a href="../doom_fire_psx/index.html">How DOOM fire was done</a></td></tr><tr><td class='ref' style='width:1ch;'><a name="footnote_19"></a><a href="index.html#back_19">^</a></td><td  class='ref' style='width:4ch;'> [19]</td><td style='width:100%;text-align:left;' class='ref'><a href="ePSXe.png">DOOM on ePSXe</a></td></tr><tr><td class='ref' style='width:1ch;'><a name="footnote_20"></a><a href="index.html#back_20">^</a></td><td  class='ref' style='width:4ch;'> [20]</td><td style='width:100%;text-align:left;' class='ref'><a href="https://github.com/Erick194/PSXDOOM-RE/blob/9c4ffe69ab76e33b7eeb1ed42a4a765573cfc26a/PSXDOOM/psxmain.c#L341">I_Error('Texture Cache Overflow');</a></td></tr></tbody></table></p> <hr>
 <center>*