<html>
<head>
  <link rel="alternate" type="application/rss+xml"  title="RSS Feed for fabiensanglard.net" href="../rss.xml" />
  <style type="text/css">

    @font-face {
      font-family: 'fabfont';
      src: url('../font/DejaVuSansMono.woff2');
      font-display: block;
    }

    @font-face {
      font-family: 'fabfont';
      src: url('../font/DejaVuSansMono-Bold.woff2');
      font-weight: bold;
      font-display: block;
    }

    * {
       font-size: 16px;
    }

    html {
      font-family: fabfont,  monospace;
      max-width: 900px;  /* For Desktop PC (see @media for Tablets/Phones) */
      padding-left: 2%;
      padding-right: 3%;
      margin: 0 auto;
      background: #F5F5F0;
  	} 
    


  	a {
      color: black;
      font-weight: bold;
    }

    img {
      border: none; 
    }

    p {
      margin-top: 0px;
      text-align: justify;
    }
    sup {
      vertical-align: 0.3em;
      font-size: 0.65em;
    }   

    pre {
      font-family: fabfont, monospace;
      background-color: white; 
      border: 1px solid Black; 
      padding-left: 2%;
      padding-top: 1ch;
      padding-bottom: 1ch;
      /* Only take care of X overflow since this is the only part that can be too wide.
         The Y axis will never overflow.
      */
      overflow: hidden;
    }

    div.heading {
      font-weight: bold;      
      text-transform: uppercase;
      margin-top: 4ch;
    }

    /** {
      font-size: 16px;
    }*/
    @media (max-width: 500px) { /* For small screen decices */
      * {
        font-size: 12px; 
      }
    }   
    .title {
      text-decoration: none;
    }

    img.pixel, canvas.pixel {
      image-rendering: pixelated;
      image-rendering: -moz-crisp-edges;
      image-rendering: crisp-edges;
    }

    blockquote { 
    background-color: #f3f3f3;
    border: dashed 1px grey; 
    width: 97.5%; 
    font-style: italic; 
    text-align: justify;

    padding: 1ch; 
    padding-top: 2ch; 
    padding-bottom: 2ch;     
    
    margin : 0ch; 
    margin-bottom: 2ch; 
    margin-top: 0ch;
  }

  blockquote div {
    text-transform: none;
    text-align: right;
    width: 100%;
  }

  code {
    /*font-size: 110%;*/
    font-weight: bold;
    background-color: #e1e1e1;
    border-radius: 0.5ch;
    padding-left: 0.3ch;
    padding-right: 0.3ch;
  }

  .trivia {
    border-left: 1px black solid;
    padding-left: 1ch;
  }

  .trivia::before {
  font-weight: bold;
  text-decoration: underline;
  padding-right: 1ch;
  content: "Trivia:";

  </style>
  <title>How Apple's Pro Display XDR takes Thunderbolt 3 to its limit</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=12.0, minimum-scale=1.0, user-scalable=yes">
</head>  
  <body><br><center>
    <div style="display: inline-block; vertical-align:middle;">
<a href="../index.html" class="title"><b>FABIEN SANGLARD'S WEBSITE</b><br>
</a><hr/><div style="text-align: justify;display: inline-block; width: 100%;">
<!-- <a class="title" href="/about/index.html">ABOUT</a> &nbsp;<a class="title" href="/contact/index.html">EMAIL</a> &nbsp;<a class="title" href="../rss.xml">RSS</a> &nbsp;<a class="title" href="https://paypal.me/fabiensanglard">DONATE</a></div></div> -->
<a class="title" href="../about/index.html">ABOUT</a> &nbsp;<a class="title" href="../contact/index.html">CONTACT</a> &nbsp;<a class="title" href="../rss.xml">RSS</a> &nbsp;<a class="title" href="https://paypal.me/fabiensanglard">GIVE</a></div></div>

</center><br><br>
<div style="margin-bottom: 2ch;text-transform: none;">
Nov 23, 2023</div>
<div class='heading'>How Apple's Pro Display XDR takes Thunderbolt 3 to its limit</div><hr/>
<p>I like Thunderbolt a lot. Mostly because USB's land of optional features is a mess which makes choosing a cable/peripheral difficult. With thunderbolt you have a single number to get right. And then you are supposed to be golden. However the idyll with Intel's interface took a hit
  when I tried to make sense of Apple's Pro Display XDR requirements.
</p>


<img loading="lazy" src="xdr5.webp" width="1308" height="438" style="width: 100%; height: auto; margin-bottom:1.5ch;margin-top:2ch;"/>
<span style="text-align: center; display: block; margin-bottom: 3ch;"><i><small>Apple's Pro Display XDR (2019)</small></i></span>

<p>If we take a look at the monitor's <a href="Pro_Display_White_Paper_Feb_2020.pdf">Technology Overview</a> we find an impressive list of features.
  On top of its gorgeous design is listed 1600 nits brightness, 6K (6,016 x 3,384)<a name="back_1" style="text-decoration: none;" href="index.html#footnote_1"><sup>[1]</sup></a> resolution, 60fps, P3 wide gamut, 32", one Thunderbolt-3 port, and three USB ports. USB-2 ports.
</p>

<p>Wait, what? USB-2? From the year 2000? As in 480 Mbps? And what are the small prints at the bottom?

<blockquote>7. For the 16-inch
MacBook Pro, USB-C ports have USB 3.1 Gen 1 data transfer speeds<a name="back_2" style="text-decoration: none;" href="index.html#footnote_2"><sup>[2]</sup></a>.</blockquote>

<p>What is going on?</p>



<div class='heading'>Let's do the math</div><hr/><p>According to Intel's Thunderbolt-3 <a href="tb3_brief.pdf">technology brief</a>, the interface has a bandwidth of 40 Gbps<a name="back_3" style="text-decoration: none;" href="index.html#footnote_3"><sup>[3]</sup></a><a name="back_4" style="text-decoration: none;" href="index.html#footnote_4"><sup>[4]</sup></a>.  With the 6,016 x 3,384 @ 60Hz / 10bpc<a name="back_5" style="text-decoration: none;" href="index.html#footnote_5"><sup>[5]</sup></a> plugged into a <a href="https://linustechtips.com/topic/729232-guide-to-display-cables-adapters-v2/?section=calc&H=6016&V=3384&F=60&bpc=10&calculations=show&formulas=show">calculator</a>, the display requires roughly 38.2 Gbps.</p>

<p>This means Thunderbolt 3 bandwidth is nearly maxed out with only 40-38.2 = 1.8Gbps left. This cannot fit the 5 Gbps needed by USB 3.1 Gen 1 traffic. But Thunderbolt still has its LowSpeed lane where USB2 can be used (the remaining bandwidth on the four HighSpeed lane is unused). The math adds up<a name="back_6" style="text-decoration: none;" href="index.html#footnote_6"><sup>[6]</sup></a>.</p>


<p>But why is the 16-inch MacBook Pro able to get USB 3.1 Gen 1 (5 Gbps) speed? Because it is able to compress the display stream!</p>

  

<div class='heading'>Thunderbolt 3</div><hr/><p>If you are a thunderbolt connoisseur, you will argue that there is no support for Display Stream Compression (DSC) in Thunderbolt 3. Intel's brief only mentions support up to DisplayPort 1.2a and there is no compression in that protocol.</p>

<p>But things get interesting when we look at the controllers. The brief of the first generation of Thunderbol3 controllers, <a href="18-241_ThunderboltController_Brief_HI.pdf">Alpine Ridge Brief (series 6000)</a>, mentions no DSC. But the brief of the second generation of controllers, <a href="18-241_Thunder7000Controller_Brief_FIN_HI.pdf">Titan Ridge (series 7000)</a>, does (via DisplayPort 1.4 support).</p>

<p>What is likely, is that there is something in the XDR which supports DisplayPort 1.4 (Titan Ridge?). And macs before the 16-inch MacBook Pro 2019 did not support it (Alpine Ridge?).</p>

<p>I am unsure it was a good idea to allow Thunderbolt 3 capabilities to differ based on the controller. On one side it allowed things like the XDR to exist. On the other, it fragmented Thunderbolt which used to be a selling point versus USB.</p>

<p>The result is that consumers have a hard time knowing if they will have USB 2 or USB 3.1 on their XDR. For a piece of hardware of that price that is rather annoying.</p>

<div class='heading'>Thunderbolt 4</div><hr/><p>What future for 6K+ displays? Thunderbolt 4 was released in 2020 along with Intel's 8000-series controllers called <a href="https://www.anandtech.com/show/16333/intel-maple-ridge-thunderbolt-4-controller-now-shipping">Maple Ridge</a>. It did not increase the bandwidth, which stayed at 40 Gbps, but it made support for DisplayPort 1.4 (and therefore DSC) mandatory.</p>

<p>This version allows supporting display configuration such as 8K@60Hz.
</p>


<div class='heading'>Thunderbolt 5</div><hr/><p>Thunderbolt 5 was <a href="TBT5&#32;Press&#32;Deck&#32;v3&#32;Final.pdf">announced</a> in September 2023. We should start seeing Barlow Ridge (series-9000) controllers in 2024.</p>

<p> The combination of 120 Gbps "Bandwidth Boost", DisplayPort 2.1, and PCIe Gen4x4 will allows multiple 8K display, up to 540Hz refresh rates, and up to three 4K@144Hz if you want to replicate Al Gore's <a href="al.webp">2007 legendary setup</a> (although he only got triple 2560 x 1600 @ 60Hz).
</p>


<div class='heading'>Thunderbolt Recap</div><hr/>
<style type="text/css">
table.usb , table.usb th, table.usb td {
  border: 1px solid black;
  border-collapse: collapse;
}
table.usb  td {
  padding-right: 1ch;
  padding-top: 0.8ch;
  padding-bottom: 0.8ch;
  text-align: right;
}

table.usb th {
  font-weight: bold;
  background-color: #BBB;
}
</style>

<p>
<table class="usb" style="width:100%;">
  <tr>
    <th>Version</th>
    <th>Release year</th>
    <th>Speed (Gbps)</th>
    <th>Speed (GBps)</th>
    <th>DisplayPort</th>
    <th>Documentation</th>
  </tr>
  <tr>
    <td style="text-align:center;">1</td>
    <td>2010</td>
    <td>10</td>
    <td>1.5</td>
    <td>1.1a</td>
    <td><a href="thunderbolt-technology-brief.pdf">Tech brief</a></td>
  </tr>
   <tr>
    <td style="text-align:center;">2</td>
    <td>2013</td>
    <td>20</td>
    <td>2.5</td>
    <td>1.2&nbsp;</td>
    <td><a href="tb2_brief.pdf">Tech brief</a></td>
  </tr>
   <tr style="vertical-align: top;">
    <td style="text-align:center;">3</td>
    <td>2015</td>
    <td>40</td>
    <td>5&nbsp;&nbsp;</td>
    <td>(Alpine Ridge) 1.2&nbsp;<br/>(Titan  Ridge) 1.4&nbsp;</td>
    <td><a href="tb3_brief.pdf">Tech brief</a></td>
  </tr>
   <tr>
    <td style="text-align:center;">4</td>
    <td>2022</td>
    <td>40</td>
    <td>5&nbsp;&nbsp;</td>
    <td>1.4&nbsp;</td>
    <td><a href="tb4_brief.pdf">Tech brief</a></td>
  </tr>
   <tr>
    <td style="text-align:center;">5</td>
    <td>2023</td>
    <td>120</td>
    <td>15&nbsp;&nbsp;</td>
    <td>2.1&nbsp;</td>
    <td><a href="Thunderbolt_5_TechBrief_2023_09_12.pdf">Tech brief</a></td>
  </tr>
</table>
<style type='text/css'>td.ref {  padding-bottom: 0ch; width:0;}</style><div class='heading'>References</div><hr/><p id='paperbox' style='text-align:left;'><table><tbody style='vertical-align: top;'><tr><td class='ref' style='width:1ch;'><a name="footnote_1"></a><a href="index.html#back_1">^</a></td><td  class='ref' style='width:4ch;'> [1]</td><td style='width:100%;text-align:left;' class='ref'><a href="https://news.ycombinator.com/reply?id=38406614&goto=item%3Fid%3D38402092%2338406614">XDR uses 6016 x 3384 but others can be 6144 x 3456! Explanation by  
'huy-nguyen'</a></td></tr><tr><td class='ref' style='width:1ch;'><a name="footnote_2"></a><a href="index.html#back_2">^</a></td><td  class='ref' style='width:4ch;'> [2]</td><td style='width:100%;text-align:left;' class='ref'><a href="setup_xdr.html">The list of Compatible Mac models has since increased</a></td></tr><tr><td class='ref' style='width:1ch;'><a name="footnote_3"></a><a href="index.html#back_3">^</a></td><td  class='ref' style='width:4ch;'> [3]</td><td style='width:100%;text-align:left;' class='ref'>TB3 line rate is 40.25. 64b/66b encoding leaves 40gbps usable.</td></tr><tr><td class='ref' style='width:1ch;'><a name="footnote_4"></a><a href="index.html#back_4">^</a></td><td  class='ref' style='width:4ch;'> [4]</td><td style='width:100%;text-align:left;' class='ref'><a href="https://news.ycombinator.com/item?id=38405841">Thanks to user fleventynine and Karoly 'chx' Negyesifor taking the time to explain it to me</a></td></tr><tr><td class='ref' style='width:1ch;'><a name="footnote_5"></a><a href="index.html#back_5">^</a></td><td  class='ref' style='width:4ch;'> [5]</td><td style='width:100%;text-align:left;' class='ref'>10 bpc is needed to achieve HDR. Regular RGB uses 8 bpc.</td></tr><tr><td class='ref' style='width:1ch;'><a name="footnote_6"></a><a href="index.html#back_6">^</a></td><td  class='ref' style='width:4ch;'> [6]</td><td style='width:100%;text-align:left;' class='ref'>Thanks to Karoly 'chx Negyesi for the precision.</td></tr></tbody></table></p> <hr>
 <center>*