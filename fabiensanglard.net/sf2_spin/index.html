<html>
<head>
  <link rel="alternate" type="application/rss+xml"  title="RSS Feed for fabiensanglard.net" href="../rss.xml" />
  <style type="text/css">

    @font-face {
      font-family: 'fabfont';
      src: url('../font/DejaVuSansMono.woff2');
      font-display: block;
    }

    @font-face {
      font-family: 'fabfont';
      src: url('../font/DejaVuSansMono-Bold.woff2');
      font-weight: bold;
      font-display: block;
    }

    * {
       font-size: 16px;
    }

    html {
      font-family: fabfont,  monospace;
      max-width: 900px;  /* For Desktop PC (see @media for Tablets/Phones) */
      padding-left: 2%;
      padding-right: 3%;
      margin: 0 auto;
      background: #F5F5F0;
  	} 
    


  	a {
      color: black;
      font-weight: bold;
    }

    img {
      border: none; 
    }

    p {
      margin-top: 0px;
      text-align: justify;
    }
    sup {
      vertical-align: 0.3em;
      font-size: 0.65em;
    }   

    pre {
      font-family: fabfont, monospace;
      background-color: white; 
      border: 1px solid Black; 
      padding-left: 2%;
      padding-top: 1ch;
      padding-bottom: 1ch;
      /* Only take care of X overflow since this is the only part that can be too wide.
         The Y axis will never overflow.
      */
      overflow: hidden;
    }

    div.heading {
      font-weight: bold;      
      text-transform: uppercase;
      margin-top: 4ch;
    }

    /** {
      font-size: 16px;
    }*/
    @media (max-width: 500px) { /* For small screen decices */
      * {
        font-size: 12px; 
      }
    }   
    .title {
      text-decoration: none;
    }

    img.pixel, canvas.pixel {
      image-rendering: pixelated;
      image-rendering: -moz-crisp-edges;
      image-rendering: crisp-edges;
    }

    blockquote { 
    background-color: #f3f3f3;
    border: dashed 1px grey; 
    width: 97.5%; 
    font-style: italic; 
    text-align: justify;

    padding: 1ch; 
    padding-top: 2ch; 
    padding-bottom: 2ch;     
    
    margin : 0ch; 
    margin-bottom: 2ch; 
    margin-top: 0ch;
  }

  blockquote div {
    text-transform: none;
    text-align: right;
    width: 100%;
  }

  code {
    /*font-size: 110%;*/
    font-weight: bold;
    background-color: #e1e1e1;
    border-radius: 0.5ch;
    padding-left: 0.3ch;
    padding-right: 0.3ch;
  }

  .trivia {
    border-left: 1px black solid;
    padding-left: 1ch;
  }

  .trivia::before {
  font-weight: bold;
  text-decoration: underline;
  padding-right: 1ch;
  content: "Trivia:";

  </style>
  <title>Street Fighter II, Spin when you can't</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=12.0, minimum-scale=1.0, user-scalable=yes">
</head>  
  <body><br><center>
    <div style="display: inline-block; vertical-align:middle;">
<a href="../index.html" class="title"><b>FABIEN SANGLARD'S WEBSITE</b><br>
</a><hr/><div style="text-align: justify;display: inline-block; width: 100%;">
<!-- <a class="title" href="/about/index.html">ABOUT</a> &nbsp;<a class="title" href="/contact/index.html">EMAIL</a> &nbsp;<a class="title" href="../rss.xml">RSS</a> &nbsp;<a class="title" href="https://paypal.me/fabiensanglard">DONATE</a></div></div> -->
<a class="title" href="../about/index.html">ABOUT</a> &nbsp;<a class="title" href="../contact/index.html">CONTACT</a> &nbsp;<a class="title" href="../rss.xml">RSS</a> &nbsp;<a class="title" href="https://paypal.me/fabiensanglard">GIVE</a></div></div>

</center><br><br>
<div style="margin-bottom: 2ch;text-transform: none;">
Dec 24, 2021</div>
<div class='heading'>Street Fighter II, Spin when you can't</div><hr/><style type="text/css">

img {
    border: 1px black solid;
}

code {
    /*font-size: 110%;*/
    font-weight: bold;
    background-color: #e1e1e1;
    border-radius: 0.5ch;
    padding-left: 0.3ch;
    padding-right: 0.3ch;
}

.center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

</style>

<p>
    <i>This article is part of a <a href="../sf2_sheets/index.html">series</a> about Street Fighter II and the CPS-1. It is recommended to read the previous entries before reading this one.</i>
</p>
  
<div class='heading'>The problem</div><hr/>  
<p> 
  As we have seen in the previous entries, the hardware running Street Fighter 2 is a tile engine that can only flip a tile vertically and/or horizontally with no blending capability. This was a problem for a game like Street Fighter II where the attract mode involves spinning the logo, scaling it up, while displaying a translucent "World Warrior" text underneath.
</p>
<p>
  If you were around in 1991, you may remember the effect was weird but it was difficult to tell what since it was spinning so fast and the CRT blurred things quite a bit.
</p>
  <img loading="lazy" src="cps1_spin.gif" class="pixel center" style="width: 70%;margin-top:2ch;margin-bottom:1ch;border:none;aspect-ratio: 4 / 3;"/><span style="text-align: center; display: block; margin-bottom: 2ch;"><i><small>A recreation of the attract mode "spin and zoom".</small></i></span>


</p>
<p>
  Via the sheet explorer, we can look at the GFXROM. The tiles used for the logo can be found in sheet <code>0x8200</code>.
</p>
    <img loading="lazy" src="0x8200.svg" class="pixel center" width="133.98253pt" height="136.40675pt" style="width: 70%; height: auto; margin-top:2ch;margin-bottom:2ch;border:none;"/><p>
   As expected we find two versions of the artwork, a small one and a large one. But how did they use them?
</p>

<div class='heading'>Mame to the rescue</div><hr/>  
<p> 
 Thanks to modern technology, we can slow down the animation. Mame can record a pixel perfect image sequence in mng format to let us look at each frame separately.
</p>
 <pre>

$ mame sf2 -mngwrite sf2.mng
 </pre> 

  <script type="text/javascript">
    function slide(e) {
      var img = document.getElementById('spin');
      img.src = "spin/sf2frames-0000" + e.value + ".png";
    }

    function slide_ce(e) {
      var img = document.getElementById('spin_ce');
      img.src = "spin_ce/sf2ce-0000" + e.value + ".png";
    }

    function slide_hf(e) {
      var img = document.getElementById('spin_hf');
      img.src = "spin_hf/sf2hf-0000" + e.value + ".png";
    }
    
    function slide_credit1(e) {
      var img = document.getElementById('credit1');
      img.src = "part1/sf2-000" + e.value + ".png";
    }

    function slide_credit2(e) {
      var img = document.getElementById('credit2');
      img.src = "part2/sf2-000" + e.value + ".png";
    }

        function slide_credit3(e) {
      var img = document.getElementById('credit3');
      img.src = "part3/sf2-000" + e.value + ".png";
    }

        function slide_credit4(e) {
      var img = document.getElementById('credit4');
      img.src = "part4/sf2-000" + e.value + ".png";
    }

    function slide_snes(e) {
      var img = document.getElementById('spin_snes');
      img.src = "snes/sf2snes-00000" + e.value + ".png";
    }
  </script>
  <img class="pixel" id="spin" src="spin/sf2frames-00001205.png" style="width:100%; aspect-ratio: 4 / 3; margin-bottom: 1ch;"/><br/>
  <input type="range" id="slider" min="00001205" max="00001300" style="width:100%" oninput="slide(this);" value="0" />
<p>
  By moving the slider left and right, we can establish that:
  <ul>
    <li>The small logo moves down to give enough clearance for the big one.
    <li>The logo spins twice.</li>
    <li>After the first spin, the small logo is replaced with the big one.</li>
    <li>The tiles are not flipped horizontally or vertically. Their positions are merely rotated around the logo center.</li>
    <li>Translucency is achieved by drawing the text every other frame.</li>
    <li>If you move fast enough the effect is visually "acceptable".</li>
  </ul>


<div class='heading'>More rotations and scaling in Street Fighter II</div><hr/>  
<p> 
  If they win the tournament without losing a round, the player is treated with a special credit sequence where more scaling and rotation occur. Again with the help of Mame we can peek at what is happening in slow-motion.
</p>

<p style="margin-top: 2ch;">
  Screen1 :
</p>
 <img class="pixel" id="credit1" src="part1/sf2-00010535.png" style="width:100%; aspect-ratio: 4 / 3; margin-bottom: 1ch;"/><br/>
  <input type="range"  min="10535" max="10577" style="width:100%" oninput="slide_credit1(this);" value="0" />
  <p style="margin-top: 2ch;">
Here, scaling up is performed by "stacking" tile on top of each others and progressively spreading them.
</p>

<p style="margin-top: 2ch;">
  Screen2 :
</p>
 <img class="pixel" id="credit2" src="part2/sf2-00010843.png" style="width:100%; aspect-ratio: 4 / 3; margin-bottom: 1ch;"/><br/>
  <input type="range"  min="10843" max="10884" style="width:100%" oninput="slide_credit2(this);" value="0" />
  <p style="margin-top: 2ch;">
Trivia: Notice how the fighters sprites appear one frame after the background. This is because the CPS-1 uses a sprite framebuffer that delays the sprite layer update by one frame. 
</p>

<p style="margin-top: 2ch;">
  Screen3 :
</p>
   <img class="pixel" id="credit3" src="part3/sf2-00011152.png" style="width:100%; aspect-ratio: 4 / 3; margin-bottom: 1ch;"/><br/>
  <input type="range"  min="11152" max="11214" style="width:100%" oninput="slide_credit3(this);" value="0" />

<p style="margin-top: 2ch;">
  Screen4 :
</p>
   <img class="pixel" id="credit4" src="part4/sf2-00011461.png" style="width:100%; aspect-ratio: 4 / 3; margin-bottom: 1ch;"/><br/>
  <input type="range"  min="11461" max="11505" style="width:100%" oninput="slide_credit4(this);" value="0" />


<div class='heading'>Street Fighter 2: Champion Edition effect</div><hr/>  
<p> 
  One year later, in March 1992, Capcom released a much improved version called "Champion Edition". To this occasion the attract mode was revamped.
  The logo does not spin anymore but it fake-scales both down and up.
</p>
  <img class="pixel" id="spin_ce" src="spin_ce/sf2ce-00001031.png" style="width:100%; aspect-ratio: 4 / 3; margin-bottom: 1ch;"/><br/>
  <input type="range" id="slider_ce" min="00001041" max="00001145" style="width:100%" oninput="slide_ce(this);" value="0" />
<p style="margin-top: 2ch;">
  The switch between small logo and big logo is hidden when all tiles are concentrated in a single point. The visual is much more compelling than the SF2:WW effect.
</p>

<div class='heading'>Street Fighter 2 Hyper Fighting</div><hr/>  
<p> 
The last game to be released on CPS-1 (after which Capcom moved to CPS-2), Street Fighter 2 Hyper-Fighting, was released in December 1992.
</p>
    <img class="pixel" id="spin_hf" src="spin_hf/sf2hf-00001106.png" style="width:100%; aspect-ratio: 4 / 3; margin-bottom: 1ch;"/><br/>
  <input type="range" id="slider_hf" min="00001105" max="00001170" style="width:100%" oninput="slide_hf(this);" value="0" />
  <p style="margin-top: 2ch;">
    The attract mode was not changed much besides the text. The text animation was removed altogether, with only the logo scaling remaining.
  </p>


<div class='heading'>Looking sideway</div><hr/>  

  <img loading="lazy" src="snes_spin.gif" class="pixel center" style="width: 35%;margin-bottom:1ch;border:none;aspect-ratio: 4 / 3; float:right; margin-left:2ch;"/><p> 
  One year after the arcade release, Capcom published a Super Nintendo port on Jul 15, 1992. They did a superb job, managing to have all the characters, moves and beautiful GFX despite using a game console with less capacity and lower resolution.
</p>
<p>Amazingly they managed to render a better spinning effect thanks to the SNES Mode 7 + HDMA.
  </p> 
  <p>
   For the subtitle translucency, a simple dithering with a sprinkle of wobbling did the trick.
    </p>
    <p>Once again, thanks to Mame, the whole animation can be inspected on a frame by frame basis.
    </p>
  
   <pre>

$ mame snes -cart "sf2.zip" -mngwrite sf2snes.mng
 </pre> 

   <img class="pixel" id="spin_snes" src="snes/sf2snes-00000495.png" style="width:100%; aspect-ratio: 4 / 3; margin-bottom: 1ch;"/><br/>
  <input type="range" id="slider_hf" min="00000495" max="00000767" style="width:100%" oninput="slide_snes(this);" value="0" /> <hr>
 <center>*