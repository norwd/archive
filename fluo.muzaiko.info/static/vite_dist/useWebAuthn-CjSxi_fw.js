import{l as C}from"./lodash-Bdl6ys83.js";function N(){let s=null;const u=e=>{if(s){const t=new Error(e);t.name="AbortError",s.abort(t)}return s=new AbortController,s.signal},b=()=>{if(s){const e=new Error("Operation cancelled.");e.name="AbortError",s.abort(e)}},d=e=>{const t="=?BINARY?B?",r="?=";if(typeof e=="object")for(const a in e)if(typeof e[a]=="string"){let n=e[a];if(n.substring(0,t.length)===t&&n.substring(n.length-r.length)===r){n=n.substring(t.length,n.length-r.length);const i=window.atob(n),l=i.length,p=new Uint8Array(l);for(let c=0;c<l;c++)p[c]=i.charCodeAt(c);e[a]=p.buffer}}else d(e[a])},o=e=>{let t="";const r=new Uint8Array(e),a=r.byteLength;for(let n=0;n<a;n++)t+=String.fromCharCode(r[n]);return window.btoa(t)},g=(window==null?void 0:window.PublicKeyCredential)!==void 0&&typeof window.PublicKeyCredential=="function",w=async()=>!g||!window.PublicKeyCredential||!PublicKeyCredential.isConditionalMediationAvailable?!1:await PublicKeyCredential.isConditionalMediationAvailable(),f=e=>{const t=C.cloneDeep(e);return d(t),t},y=e=>{const t=e.response;return{transports:t.getTransports?t.getTransports():null,clientDataJSON:t.clientDataJSON?o(t.clientDataJSON):null,attestationObject:t.attestationObject?o(t.attestationObject):null}},A=async e=>{const t=f(e),r=u("New registration started."),a={...t,signal:r},n=await navigator.credentials.create(a);return y(n)},h=e=>{const t=e.response;return{id:e.rawId?o(e.rawId):null,clientDataJSON:t.clientDataJSON?o(t.clientDataJSON):null,authenticatorData:t.authenticatorData?o(t.authenticatorData):null,signature:t.signature?o(t.signature):null,userHandle:t.userHandle?o(t.userHandle):null}};return{isSupported:g,isConditionalSupported:w,doValidate:async(e,t=!1)=>{const r=f(e),a=t?{mediation:"conditional"}:{},n=u("New validation started."),i={...r,...a,signal:n},l=await navigator.credentials.get(i);return h(l)},doRegister:A,cancel:b}}export{N as u};
